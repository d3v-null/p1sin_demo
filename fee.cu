// This Source Code Form is subject to the terms of the Mozilla Public
// License, v. 2.0. If a copy of the MPL was not distributed with this
// file, You can obtain one at http://mozilla.org/MPL/2.0/.

#define HIP_ENABLE_PRINTF

#include "fee.h"
#if __HIPCC__
#include "hip_helpers.cuh"
#endif

__global__ void print_coeffs(const FEECoeffs *d_coeffs)
{
    printf("d_coeffs: %p\n", &d_coeffs);
    printf("d_coeffs->x_q1_accum: %p\n", d_coeffs->x_q1_accum);
    for (int i = 0; i < 1056; i++)
    {
        printf("%f, ", d_coeffs->x_q1_accum[i]);
    }
    printf("d_coeffs->x_q2_accum: %p\n", d_coeffs->x_q2_accum);
    for (int i = 0; i < 1056; i++)
    {
        printf("%f, ", d_coeffs->x_q2_accum[i]);
    }
    printf("d_coeffs->x_m_accum: %p\n", d_coeffs->x_m_accum);
    for (int i = 0; i < 528; i++)
    {
        printf("%d, ", d_coeffs->x_m_accum[i]);
    }
    printf("d_coeffs->x_n_accum: %p\n", d_coeffs->x_n_accum);
    for (int i = 0; i < 528; i++)
    {
        printf("%d, ", d_coeffs->x_n_accum[i]);
    }
    printf("d_coeffs->x_m_signs: %p\n", d_coeffs->x_m_signs);
    for (int i = 0; i < 528; i++)
    {
        printf("%d, ", d_coeffs->x_m_signs[i]);
    }
    printf("d_coeffs->x_m_abs_m: %p\n", d_coeffs->x_m_abs_m);
    for (int i = 0; i < 528; i++)
    {
        printf("%d, ", d_coeffs->x_m_abs_m[i]);
    }
    printf("d_coeffs->x_lengths: %p\n", d_coeffs->x_lengths);
    for (int i = 0; i < 1; i++)
    {
        printf("%d, ", d_coeffs->x_lengths[i]);
    }
    printf("d_coeffs->x_offsets: %p\n", d_coeffs->x_offsets);
    for (int i = 0; i < 1; i++)
    {
        printf("%d, ", d_coeffs->x_offsets[i]);
    }
    printf("d_coeffs->y_q1_accum: %p\n", d_coeffs->y_q1_accum);
    for (int i = 0; i < 1056; i++)
    {
        printf("%f, ", d_coeffs->y_q1_accum[i]);
    }
    printf("d_coeffs->y_q2_accum: %p\n", d_coeffs->y_q2_accum);
    for (int i = 0; i < 1056; i++)
    {
        printf("%f, ", d_coeffs->y_q2_accum[i]);
    }
    printf("d_coeffs->y_m_accum: %p\n", d_coeffs->y_m_accum);
    for (int i = 0; i < 528; i++)
    {
        printf("%d, ", d_coeffs->y_m_accum[i]);
    }
    printf("d_coeffs->y_n_accum: %p\n", d_coeffs->y_n_accum);
    for (int i = 0; i < 528; i++)
    {
        printf("%d, ", d_coeffs->y_n_accum[i]);
    }
    printf("d_coeffs->y_m_signs: %p\n", d_coeffs->y_m_signs);
    for (int i = 0; i < 528; i++)
    {
        printf("%d, ", d_coeffs->y_m_signs[i]);
    }
    printf("d_coeffs->y_m_abs_m: %p\n", d_coeffs->y_m_abs_m);
    for (int i = 0; i < 528; i++)
    {
        printf("%d, ", d_coeffs->y_m_abs_m[i]);
    }
    printf("d_coeffs->y_lengths: %p\n", d_coeffs->y_lengths);
    for (int i = 0; i < 1; i++)
    {
        printf("%d, ", d_coeffs->y_lengths[i]);
    }
    printf("d_coeffs->y_offsets: %p\n", d_coeffs->y_offsets);
    for (int i = 0; i < 1; i++)
    {
        printf("%d, ", d_coeffs->y_offsets[i]);
    }
    printf("\n");
}

int main(int argc, char *argv[])
{
#if __HIPCC__
    h_report_on_device(0);
#endif

    int num_directions = atoi(argv[argc - 1]);
    printf("num_directions: %d\n", num_directions);
    FLOAT az_rad[num_directions];
    FLOAT za_rad[num_directions];
    FLOAT PI = 3.14159265358979323846;
    for (int i = 0; i < num_directions; i++)
    {
        az_rad[i] = 0.4 + 0.3 * PI * ((FLOAT)i / (FLOAT)num_directions);
        za_rad[i] = 0.3 + 0.4 * PI * ((FLOAT)i / (FLOAT)num_directions) / 2.0;
        // printf("[%d] az %f, za %f\n", i, az_rad[i], za_rad[i]);
    }
    FLOAT *d_azs, *d_zas;
    GPUCHECK(gpuMalloc(&d_azs, num_directions * sizeof(FLOAT)));
    GPUCHECK(gpuMalloc(&d_zas, num_directions * sizeof(FLOAT)));
    GPUCHECK(gpuMemcpy(d_azs, az_rad, num_directions * sizeof(FLOAT), gpuMemcpyHostToDevice));
    GPUCHECK(gpuMemcpy(d_zas, za_rad, num_directions * sizeof(FLOAT), gpuMemcpyHostToDevice));
    printf("Here1\n");

    const FLOAT x_q1_accum[1056] = {0.0014612172605981363, 0.004089047437594963, 9.020597604816347e-7, 3.2125152738497883e-7, 0.001458802741066274, 0.004089887674024818, 0.00036505860832368193, -0.0001283436469923117, 0.006452346336257103, -0.0026327778404722823, 4.770317195891159e-7, -7.768349868961816e-7, 0.006454507087228513, -0.0026328102005112814, -0.0003653372255564911, 0.00012741853229641833, -7.52352362474914e-5, -0.0005135185264516138, -0.0007939588569983851, -0.0017397410992729485, -0.0038858824627338727, -0.008786837302898467, 3.092309637173083e-7, -6.941923999927244e-7, -0.0038863450186733773, -0.008789570848113243, 0.0007926487084039305, 0.0017396170202847133, -7.685298444294727e-5, -0.0005129891279759708, 3.883874161845561e-5, 6.223573307342841e-6, -0.00027454582275731633, 7.691975351810761e-5, -0.003206096283654416, 0.0014630962384494467, -0.00993045294827173, 0.004514020324714668, -5.360131869604039e-7, -1.7336335737670437e-6, -0.009931505831493957, 0.004513172455398109, 0.0032055302817495046, -0.001462046098224424, -0.0002754500908955683, 7.806050532384014e-5, -3.8138907473342815e-5, -7.362854552084695e-6, -0.0004665473915498193, -0.0005466945685711532, 0.00011031898421648369, 6.767473237517265e-5, -9.636683564638062e-5, -0.0004515183172576345, 0.0016657850770327531, 0.0038405980205171507, 0.004012573923295971, 0.00902012392626026, -2.59537110053928e-6, 1.801127533444368e-7, 0.004008856233109528, 0.009020066042016071, -0.0016647270143164735, -0.0038400248447577378, -9.563785708628886e-5, -0.0004495089152499871, -0.00011087137481285628, -6.808460605893616e-5, -0.00046813225388957246, -0.0005470277350076503, -0.0005540740373928402, 0.0003165989678717164, -0.0010269722831437436, 0.0007439471463524286, 0.00015684722857883283, -0.00017884905174530053, -0.0011263662271947267, 0.0003508690850119899, 0.003395750930607818, -0.0013423363490132946, 0.006471597835878919, -0.0026526590208834203, 4.404434903620448e-8, 2.5316565366130593e-6, 0.006470423025109907, -0.0026478882404931316, -0.0033954415892751915, 0.0013415905776563652, -0.0011246935708687004, 0.0003510053287897122, -0.00015690894983073195, 0.00017837907371523562, -0.001026955064155006, 0.0007451641889317958, 0.0005534607257882595, -0.00031658995116371326, 4.6115711014437324e-5, -6.953571971109746e-5, 0.0004023379794712001, 0.0007544091896549744, 0.0007098436912699991, 0.00115691913370078, -0.00013260133899960187, -0.00012508874832022163, 0.0004599681938272329, 0.0012846388806230483, -0.0008016336629946056, -0.002345110653573107, -0.0012680994697317214, -0.003688447256571331, 1.9912143303473222e-6, -4.61809255384053e-8, -0.0012640801405455024, -0.0036874954147204007, 0.0008007699245833122, 0.0023450166571851792, 0.00045992081151032134, 0.001284119971064507, 0.00013158463427408466, 0.00012474801791395606, 0.0007101405363634404, 0.001156349589963709, -0.00040228744115443924, -0.0007539088079810526, 4.59189150278033e-5, -6.86638333421773e-5, 0.0001493750518263301, -0.00012532068802937395, -0.0002025398388131331, 1.749129748666265e-5, 0.000631586674825983, -0.00029141611287790745, 0.0008634292034038512, -0.0004267743771768868, -2.887319836933507e-5, 3.095592471523108e-5, 0.000942821416982511, -0.00033600454294802757, -0.0013250692953175188, 0.000368175157532336, -0.0017939968679909824, 0.00046439935578180815, 2.536457807580505e-8, -1.4063096752738068e-6, -0.001793327186959118, 0.00046125754835594655, 0.0013251316710816167, -0.0003671881396138288, 0.0009430524660556076, -0.00033590891703558353, 2.852135144412743e-5, -3.014710032242201e-5, 0.0008629405613246472, -0.0004261710877075832, -0.0006312927420288995, 0.0002913152621467249, -0.00020175407711623105, 1.7607064257110317e-5, -0.0001493952514545695, 0.00012515185778448596, 0.00013598498813852206, 0.0001606478686005727, -0.0001000289774251585, -0.00010390619958568144, 8.34423750852472e-5, 0.00025916540305879793, -0.0001228992556372768, -0.0003702932684071776, -0.00014171755116129903, -0.0004323276678343531, -2.287934367374598e-5, -1.9927801033856366e-5, -0.00012831898610979705, -0.0004810451983566296, 0.00014300625031876522, 0.0006525170707912534, 0.00019562459867899438, 0.000872976450141355, -8.915490280902999e-7, -9.02725974834121e-8, 0.00019360361770520213, 0.0008723843881542621, -0.00014240536645997092, -0.0006525620812769606, -0.00012822657658715845, -0.0004812468661822718, 2.3353166440912693e-5, 2.0151546121268315e-5, -0.00014096821900860283, -0.0004321210281403453, 0.0001226183494411329, 0.00037031117723887436, 8.339204653726976e-5, 0.00025888281320303897, 9.987157159434154e-5, 0.00010386953294706452, 0.0001358874734861186, 0.00016075775390667454, 4.958378548776104e-5, -3.752975353468498e-5, 0.00013892088673159256, -0.00012125576058499649, 5.514225430878732e-6, 1.2508462200741269e-5, 0.00017606344199072487, -6.893262452812137e-5, -0.00017074462216303156, 2.644232208186298e-5, -0.00016364734688609252, 1.8131608476083246e-5, -3.882351984328187e-6, 1.1477527526398708e-5, -0.00020139273611158195, 1.6270706504217954e-5, 0.0002976546051169462, -5.371687692141249e-5, 0.00042384442262067624, -0.00010435490921982372, -4.504708503506633e-8, 4.832561665777253e-7, 0.0004234721937169209, -0.00010313603513320808, -0.00029769590948712033, 5.344492602104332e-5, -0.00020144418589998874, 1.6403258893571578e-5, 4.033672778364981e-6, -1.1813108948941262e-5, -0.00016359665562137605, 1.7712113025297498e-5, 0.0001708353084378903, -2.6160840668576764e-5, 0.00017619910634491867, -6.879462004525314e-5, -5.557141123645174e-6, -1.2417672901510893e-5, 0.00013903422052804744, -0.0001211520620431434, -4.98129584527644e-5, 3.7411667542180595e-5, 3.529342141748533e-7, 6.500993114625925e-6, -3.445693743321808e-5, -4.5864689968849226e-5, -3.1786716564384675e-5, -3.735199877588854e-5, -2.7466694776541418e-5, -3.8686219418614485e-5, -9.097369475434596e-6, -5.1810160091639225e-5, 8.96598279836473e-6, 7.794263358386859e-5, 1.5182164539333802e-5, 8.676260359886157e-5, -8.427967098002211e-6, -1.4516897940977895e-5, 1.1969609939603582e-5, 0.00010538622410119795, -1.5566810177336995e-5, -0.00012225839970923517, -1.543560187309902e-5, -0.00013428707692878688, 2.3114472031758972e-7, 3.20746563056557e-8, -1.4814813487329769e-5, -0.00013417247826825142, 1.5431450793450998e-5, 0.00012230020237559173, 1.208664532877286e-5, 0.00010548397142802066, 8.160081452643875e-6, 1.4426913687448699e-5, 1.4953364237187392e-5, 8.67001024986432e-5, -8.812970082989649e-6, -7.798455047151583e-5, -9.007915068013896e-6, -5.193159733034201e-5, 2.7493616027639906e-5, 3.872953100078636e-5, -3.170415701834293e-5, -3.7430107489738883e-5, 3.434491033295116e-5, 4.611039884777088e-5, 2.777765436015512e-7, 6.6185909404431365e-6, -5.771268173037741e-6, 6.377865059166381e-6, 8.465842431405885e-6, -9.824172742149421e-7, -1.5667773236779687e-5, 9.713108855713684e-6, 1.272413739612472e-5, -2.0453408764072628e-5, 2.1954671540350693e-6, 5.2077658890826905e-6, -1.6239482426203526e-6, -1.556137890366837e-5, 3.707326735874029e-5, -1.0264252148089367e-5, 5.97095902315621e-5, -1.8985316542092683e-5, -4.104109677017741e-6, 3.6399806115255814e-6, 5.779449180046443e-5, -1.9669074033514634e-5, -3.952955687576699e-5, -7.568650134567383e-7, -5.377621881465719e-6, -2.506792597813919e-5, 1.5331113338227224e-8, -1.1511719973647587e-7, -5.371031329670021e-6, -2.5315154132789943e-5, 3.953984570665253e-5, 8.504226181120828e-7, 5.7918101936915984e-5, -1.9718718586710863e-5, 4.072979460681812e-6, -3.500971498961139e-6, 5.9626567216570325e-5, -1.8783660925495098e-5, -3.7087640104065e-5, 1.022172060565106e-5, -1.6142527838480378e-6, -1.556537677035487e-5, -2.1834172653369035e-6, -5.239378152807677e-6, 1.2689525540488286e-5, -2.051368775305756e-5, 1.5797319040902442e-5, -9.658860665511361e-6, 8.585539287934947e-6, -9.077082601787533e-7, 5.784917007575002e-6, -6.354582602164965e-6, -4.530621943496528e-6, -4.63854766885412e-6, 5.545951343644742e-6, 4.154862412483324e-6, -1.0784481634701412e-6, -6.0052001778536786e-6, -5.845521873167499e-6, -2.0141677054744767e-6, -7.03938722163911e-6, 7.0969359708427135e-6, -1.4326645104125458e-5, -2.2829185877533815e-5, 2.001722488597005e-6, 1.602451824685036e-5, -1.1324888899315702e-6, -1.0801095723535666e-5, 2.0465233941729516e-6, -1.3192744239555258e-5, -6.480367607336812e-6, -8.22924742358015e-6, 4.478921301174166e-7, -8.156992034294671e-6, -1.2075672777975636e-6, 1.1177660650069208e-5, 1.6561547548046562e-6, 1.781274667526088e-5, -6.036761619547629e-8, -5.803643567455104e-9, 1.5437533103522554e-6, 1.7774787726624933e-5, 1.2621631575671822e-6, -1.117017463847269e-5, 4.4033697854043914e-7, -8.1903646579556e-6, 6.505264558251814e-6, 8.22813953719087e-6, 2.1742429685864664e-6, -1.3193835866922377e-5, 1.116746814051301e-6, 1.0832502806172587e-5, 2.0188047786148835e-6, 1.6014718051625544e-5, 1.4287601453447331e-5, 2.283057682363455e-5, -7.086738623784898e-6, 7.11998216480641e-6, 5.8538626100668416e-6, 1.988799090455082e-6, -1.0540854046404511e-6, -6.061614096847365e-6, -5.519843258233039e-6, -4.167682969158263e-6, -4.491963665823568e-6, -4.682198509483335e-6, -9.068041868757112e-7, 7.317091751851737e-7, -3.7397947571852085e-6, 4.020192096001848e-6, -2.756991152849204e-7, -1.0471287700251402e-6, -2.207256238147261e-6, 4.069170318445231e-7, 1.6235462470937896e-6, 2.7227936665014216e-6, 2.140723833223936e-5, -1.3024096470633722e-5, 1.147800072189132e-6, 2.3535442136201854e-6, 1.9444878679077495e-5, -1.1839632561702505e-5, 3.2790110967888427e-7, -5.439835686959036e-6, 1.3094925029061007e-5, -1.1202475990005776e-5, -2.2400839084517405e-6, 2.6571256701938893e-6, 1.0354635816447289e-5, -1.2645663234204653e-5, 6.5126647270799285e-6, -2.267828832005787e-6, 3.616042369812449e-5, -2.0988404734580326e-5, -2.8573144819727166e-9, 1.9631747919825326e-8, 3.611234415425488e-5, -2.0913256425492813e-5, -6.51743799137408e-6, 2.2712931752876347e-6, 1.0393308863372341e-5, -1.2622935549100045e-5, 2.2485683991225307e-6, -2.6714421906818966e-6, 1.305456768074255e-5, -1.1216474045548969e-5, -3.0906305248965995e-7, 5.4714150589727056e-6, 1.949099362749599e-5, -1.1828014497485358e-5, -1.1491657350370016e-6, -2.335263709356267e-6, 2.1424496681052098e-5, -1.2993240506355646e-5, -1.6302561578999877e-6, -2.730486960028281e-6, -2.2115744121766145e-6, 4.1374520626299424e-7, 2.689029964637852e-7, 1.03289179841018e-6, -3.7847897566129608e-6, 3.980010354282806e-6, 9.31276213705574e-7, -7.210663564464675e-7, 2.2571365347983076e-8, -1.0054262745366547e-7, 6.417670539650017e-7, 7.545388135240693e-7, 8.307326950676357e-7, 3.990201038501126e-7, 1.4362711402798542e-6, 1.7605181666937979e-6, -2.776760131009526e-7, 2.240366070004237e-7, -3.371025051875591e-6, -5.929012940600647e-6, -4.118200040208979e-6, -1.1578405965344905e-6, -9.612422472033582e-6, -1.5555139654561667e-5, 1.4296814987377969e-6, 3.273486652514345e-6, -9.351308014645789e-7, 1.5691056185264384e-6, 1.5277799757503182e-6, 3.069499545304706e-7, -4.424888931538949e-6, -5.954602633609977e-6, -5.188064378623925e-8, 4.142182169978417e-6, -9.939124499797923e-7, -3.335387592176111e-6, 3.816566995862618e-7, -5.245696610153782e-7, 2.526748551897465e-10, 2.5870732928741307e-9, 4.0741465482218033e-7, -5.294534142721065e-7, 1.0071235740476577e-6, 3.3492570928625058e-6, -2.5583562611836355e-8, 4.139837334060117e-6, 4.391197791111293e-6, 5.943397180490578e-6, 1.538778934033415e-6, 2.9956902834105077e-7, 9.568042539401843e-7, -1.5610493653102074e-6, 1.4384739643497576e-6, 3.2489292414996457e-6, 9.612026869976217e-6, 1.555885208711273e-5, -4.110185126446375e-6, -1.1612345818899788e-6, 3.356973536473846e-6, 5.9493714898165385e-6, -2.755230241777788e-7, 2.2369793710795467e-7, -1.438532254584483e-6, -1.7603723246134527e-6, 8.134696856659642e-7, 4.174312395719699e-7, -6.31032332572563e-7, -7.794986168548133e-7, 2.627509140815884e-8, -1.0926573084341751e-7, 4.515952853423191e-8, -7.029693611144999e-8, -8.040801336704224e-8, -4.2878670973107016e-8, 1.0975507068482122e-7, -1.1488957204948263e-7, -1.0528270279217478e-6, 1.0172730094413988e-6, 1.2086377723361059e-8, -4.4886167500711407e-7, 1.2979442391833806e-7, 3.0279369817984383e-7, -7.124754970184346e-7, 1.4736176692526075e-6, 1.276930026353544e-5, -8.58057551896483e-6, 7.168135509306077e-7, 1.488780898040951e-6, 1.1722396299076062e-5, -8.861428690392536e-6, 2.9208828027894647e-6, -3.5089996308164817e-6, 1.252783358611471e-5, -8.071123098367258e-6, -1.775357643226845e-6, 1.9573322038070148e-6, 1.0874663940689705e-5, -8.990099137446662e-6, 9.361998700712169e-7, -1.5612294735168344e-6, 2.2982549040833083e-5, -1.5526448712112873e-5, 3.3310067613024535e-10, -3.0512944243844836e-9, 2.2944603669771095e-5, -1.5509155215031024e-5, -9.371515368493546e-7, 1.5725664723059427e-6, 1.0910203271285643e-5, -8.986853510208476e-6, 1.7769733282726382e-6, -1.9449414140758834e-6, 1.2505444560220569e-5, -8.056868881502086e-6, -2.914579291513677e-6, 3.519028207952922e-6, 1.1745152986224902e-5, -8.857809348763251e-6, -7.163704113548269e-7, -1.487641965978249e-6, 1.2773542827745005e-5, -8.578481283982648e-6, 7.224294374673583e-7, -1.4700679746575686e-6, 1.3939161151635555e-7, 3.1072088777867136e-7, -1.2955940140298111e-8, 4.485336834276907e-7, -1.0554138747681964e-6, 1.0161174211746975e-6, -1.1948619233888798e-7, 1.1095378250881339e-7, -8.931440284643162e-8, -4.6316940439975804e-8, -4.570305461045088e-8, 6.904476713816833e-8, 3.437981685814405e-8, 3.7447571720640515e-8, -7.067107491073842e-8, -4.177824003785629e-8, -4.152029248221664e-8, 8.498829187866657e-9, 1.8451214695828268e-7, 1.9222235031363344e-7, 3.7114504970563543e-7, 2.9213749300084148e-8, 7.875677011289229e-7, 1.0283815608306153e-6, -4.518080545241289e-8, -2.887295898961637e-7, -2.2386796293469883e-6, -3.5377162986846166e-6, -2.669624220886668e-6, -2.3702848448535454e-7, -6.949852065765923e-6, -1.1494963028840823e-5, 8.091040515027372e-7, 2.8843052933799295e-6, -6.885962647616131e-7, 4.5289379330481176e-7, 1.021689334504378e-6, -8.417114700523581e-7, -3.1039267027013057e-6, -4.2588607097272766e-6, 2.6846454116850425e-8, 1.8913323823620667e-6, -6.774001408562628e-7, -1.178981341599325e-6, 2.8311676973678996e-7, 7.165149137392652e-7, -6.778846727534182e-9, 1.7993511179446837e-9, 2.8638342498672025e-7, 7.10738064899382e-7, 6.921656785552294e-7, 1.1865917794687717e-6, 3.880376458535625e-8, 1.8869017445303162e-6, 3.085990758504411e-6, 4.249185424451966e-6, 1.0420782677989416e-6, -8.463996860502664e-7, 7.001106354928313e-7, -4.4502969390838524e-7, 8.165708738506407e-7, 2.871122043388507e-6, 6.943929767790942e-6, 1.1496519323445519e-5, -2.672268488380179e-6, -2.3625849412225593e-7, 2.232007524108962e-6, 3.545747464572583e-6, -4.316591639157713e-8, -2.9383514301518217e-7, -7.857055475107762e-7, -1.0290429254587746e-6, 3.692506815591648e-7, 3.205752630319851e-8, -1.8349338919626417e-7, -1.9440966297989747e-7, -4.251314594690215e-8, 1.1833009885469445e-8, 6.93307387826877e-8, 4.2350434037874646e-8, 3.317361148697109e-8, 3.8754976343456836e-8, 5.571129255976255e-9, -2.7514282993043835e-9, 3.5602390511534104e-8, -3.441537434143131e-8, -1.0709691069046416e-8, 2.502311940877337e-8, -2.039108315270466e-8, 1.8488061192813352e-8, 1.0542263295510205e-8, -6.747604879229208e-8, -7.268895963668785e-7, 5.361920579629764e-7, 4.339075294561794e-8, -2.917820835293875e-7, -2.7987219617814898e-8, 1.376567336475959e-7, -3.4553692590913605e-7, 9.746735897871496e-7, 9.669932546549745e-6, -6.120292899169238e-6, 4.206100729911942e-7, 1.0548126720468871e-6, 9.231154756805778e-6, -6.696798564851781e-6, 1.8086959227770743e-6, -2.4870713115211752e-6, 9.083251942262272e-6, -6.075312672371869e-6, -1.2989940120236403e-6, 1.3979856419110363e-6, 8.003590358684718e-6, -6.895727798627689e-6, 9.687674657387315e-7, -1.1251758518919454e-6, 1.826969737972094e-5, -1.2072976330577886e-5, -2.4352343896548328e-11, 2.601059001124132e-11, 1.8243725389196296e-5, -1.2056283887034087e-5, -9.698012274952008e-7, 1.1323700273224224e-6, 8.033882133340193e-6, -6.894283720573154e-6, 1.3000605498467301e-6, -1.3925733985910067e-6, 9.062711254903577e-6, -6.067100852440768e-6, -1.803081401938986e-6, 2.4953684195845203e-6, 9.245544181959094e-6, -6.692478685775239e-6, -4.201621977743516e-7, -1.0522487989977024e-6, 9.673450516968136e-6, -6.116732337726462e-6, 3.500447195337016e-7, -9.735491729392608e-7, -2.3079227786103003e-8, 1.4261242674920159e-7, -4.419335682411136e-8, 2.9026272962772755e-7, -7.304349611658739e-7, 5.329969039454299e-7, -1.2512551676110556e-8, 6.675693211630534e-8, -2.1329296428362416e-8, 1.785074748566538e-8, 1.094661857951275e-8, -2.4440014685074944e-8, 3.693880317576169e-8, -3.3169625349018386e-8, -6.040797994629758e-9, 2.5720719532879954e-9, -1.0919920691856219e-9, 2.798629384836097e-10, -2.6165051565225915e-9, -5.02642005768692e-9, -1.2086639915943495e-8, -1.0837991466016757e-8, -9.854262567207857e-9, -8.788876590161273e-9, -2.1487755486891953e-9, -3.461751134067293e-9, 8.989776182159526e-8, 1.3797503761057496e-7, 2.2439813711103505e-7, 7.198374897529425e-8, 4.889841300270584e-7, 6.898679503743761e-7, -4.669827488233596e-8, -1.5352562924161424e-7, -1.574172290797984e-6, -2.670136378304586e-6, -1.8437897230096764e-6, -2.785806714132467e-7, -5.2536829803475815e-6, -8.853179958173195e-6, 5.855150576665848e-7, 1.9752214363149866e-6, -5.794991698228086e-7, 5.224159216658872e-7, 7.416390667069866e-7, -5.723793973444363e-7, -2.327506862526671e-6, -3.229539942001393e-6, -9.44520820454132e-9, 1.4220222780735623e-6, -4.898422879958843e-7, -8.872645468327934e-7, 1.8309380313799232e-7, 3.8817100082371274e-7, -4.6101453586252625e-9, 1.5712978601065567e-9, 1.873834267992503e-7, 3.842677936458319e-7, 5.040376049429884e-7, 8.947559835793913e-7, 5.144722610220093e-10, 1.4194424574741359e-6, 2.3141606783231e-6, 3.2229105022416537e-6, 7.547732603107175e-7, -5.762127550329527e-7, 5.89376552598457e-7, -5.157149320458926e-7, 5.89906066370901e-7, 1.9653040273134995e-6, 5.248788445874845e-6, 8.854821357252811e-6, -1.8442398663522544e-6, -2.78697779113157e-7, 1.5693010125043459e-6, 2.67655032344014e-6, -4.5382255460071584e-8, -1.5621578395061635e-7, -4.883874042982251e-7, -6.902360512743631e-7, 2.223252952731316e-7, 7.443368958662921e-8, -8.894652907927303e-8, -1.3999890793442503e-7, -2.4469924686056317e-9, -2.678486862743872e-9, 9.774822983613716e-9, 8.845605905660865e-9, -1.160617893526193e-8, -1.1342834789191846e-8, 2.4364890442541212e-9, 5.506574715972034e-9, -1.1350967958272222e-9, 4.115746801388889e-10, -3.121651571862427e-10, 4.630442191657446e-10, 1.8070708743463442e-10, 1.1703169281318073e-9, -1.0321952169718808e-9, 7.703101372612068e-10, 5.228624709524369e-9, -4.762501858707745e-9, -3.6754445166838947e-9, 7.480672762670207e-9, -1.765183771848487e-8, 4.101799162390167e-9, 1.792538177106424e-8, -3.833225442327114e-8, -4.823380782524994e-7, 3.3839928625672453e-7, 3.436197950486508e-8, -1.861908256970213e-7, -4.896242879947851e-9, 1.0521393293872659e-7, -2.707594686098931e-7, 6.710412718459664e-7, 7.468759289505568e-6, -4.615601598702703e-6, 2.7874713911385227e-7, 7.576145604929397e-7, 7.320879804939388e-6, -5.299315803171802e-6, 1.3416772928510542e-6, -1.8204923490560413e-6, 7.094798448030881e-6, -4.7691571027779435e-6, -9.888670902477603e-7, 1.048246833337487e-6, 6.337150347783369e-6, -5.4419902290019005e-6, 6.927006736257685e-7, -8.36571546618029e-7, 1.4622450798025848e-5, -9.650438649091267e-6, 1.6868326960531425e-11, -2.3099053271098554e-10, 1.4595642721065363e-5, -9.635771716366356e-6, -6.93342924104897e-7, 8.417590952300819e-7, 6.3635343345705525e-6, -5.442719977683112e-6, 9.897649182179753e-7, -1.0437695509443042e-6, 7.075802714470634e-6, -4.762632286488968e-6, -1.3378576167153152e-6, 1.8262855301187032e-6, 7.333049496155017e-6, -5.298470400460948e-6, -2.785944830557649e-7, -7.558875926515895e-7, 7.471539968982311e-6, -4.612995227805339e-6, 2.741918874270469e-7, -6.700141989776401e-7, -1.536899746586182e-9, 1.089870009686872e-7, -3.487051220368641e-8, 1.8541195026579187e-7, -4.843429045317994e-7, 3.367117686942819e-7, -1.9364062212141923e-8, 3.779827187720665e-8, -1.8383617470731107e-8, 3.720346974607922e-9, 3.73926048973157e-9, -7.355533120897359e-9, 5.390941763523545e-9, -4.628305836082924e-9, 1.210122530912581e-9, -7.068786305190803e-10, 3.152301270297696e-10, 1.2120902194405821e-9, 3.1655338466759074e-10, -4.503358746963784e-10, -6.704208258664999e-10, -5.092911965409531e-10, 4.0653150323421085e-10, 4.074866344337008e-10, 5.975115520626133e-10, 1.0287295885673623e-10, -4.184503085309365e-10, -1.358057931807957e-9, -3.647943512760447e-9, -1.928732965873119e-9, -6.181327049712204e-9, -5.021713645370843e-9, -2.8128021005416675e-9, 1.0768824532308104e-10, 5.7554872244796956e-8, 9.132050242031079e-8, 1.4541788955548694e-7, 4.983672580261531e-8, 3.4709639758997283e-7, 5.080033536686481e-7, -3.02103054599692e-8, -1.1073157334892343e-7, -1.1813580162066936e-6, -2.0645623974642126e-6, -1.329630247272789e-6, -2.2381605009238868e-7, -4.1370029419181675e-6, -7.059473594925734e-6, 4.2685446137465233e-7, 1.4510436818131543e-6, -4.954138896751778e-7, 4.6417281093130847e-7, 5.504734057673949e-7, -4.5584235773512424e-7, -1.8047252483682876e-6, -2.5307154227976056e-6, -1.7253878318330947e-8, 1.044999829081774e-6, -3.702171433365062e-7, -6.325806839558924e-7, 1.2866396420356507e-7, 2.7210714597455623e-7, -4.508158870596418e-9, 2.1381956511016352e-10, 1.3167273359629113e-7, 2.691148796395859e-7, 3.8128960238403905e-7, 6.37747800744964e-7, -9.95842218818802e-9, 1.0428764981436484e-6, 1.7927519038629194e-6, 2.523518302819852e-6, 5.605499481856346e-7, -4.584574900510218e-7, 5.027860857318763e-7, -4.6249240676674693e-7, 4.304192083388885e-7, 1.4438181681131247e-6, 4.1347135559576e-6, 7.061093793078268e-6, -1.3299901557289495e-6, -2.2384038334085674e-7, 1.1777645993733408e-6, 2.0697248453970845e-6, -2.931200447560485e-8, -1.1264522686930102e-7, -3.4664403314930846e-7, -5.082230137032223e-7, 1.4420396365235533e-7, 5.1355436167487986e-8, -5.698744859023507e-8, -9.251313024909804e-8, -2.9874456342952245e-9, 6.430098707163033e-10, 6.096561970938205e-9, 5.0599960009492335e-9, -3.5244918438430683e-9, -2.072912881732393e-9, 3.937786693100583e-10, 1.4210688062766353e-9, 6.092786391669573e-10, 5.349094487137964e-11, -3.929140847314496e-10, -4.1212045031823536e-10, -6.608179212313157e-10, -5.204876477943008e-10, -2.893445145007709e-11, 5.230089683924447e-12, -2.8699393874713904e-10, 1.4911660339884055e-10, 1.0205007122337207e-10, -3.528188855834346e-10, 3.750671871345509e-11, 1.0295616739690438e-10, -6.375922407798789e-10, 2.637589298693416e-10, 6.140437178364114e-9, -3.2639546919958918e-9, -3.0513966117268636e-9, 7.880041560536646e-9, -9.4769490433632e-9, 3.289777588776617e-9, 2.1399491053887336e-8, -2.3359619448896294e-8, -3.972730688925394e-7, 2.154917796841644e-7, 5.852394290955003e-8, -1.4714283042027316e-7, 9.779692265591833e-8, -8.064798968538373e-8, -2.822017000261608e-7, 5.63851340663586e-7, 9.96810931695461e-6, -5.322878026801636e-6, 1.1334316979617793e-7, 6.280537217477649e-7, 8.768404919720338e-6, -5.476363037786221e-6, 1.7227555774112486e-6, -1.7071044835070924e-6, -4.208092513747659e-6, 1.1194214234695562e-6, -1.1388746549721e-6, 7.273453368125044e-7, -3.834760395795941e-6, 1.1115423523034739e-6, 5.213019277850709e-7, -2.5491381247170286e-7, 1.5017010144250191e-5, -8.082818735017193e-6, -3.0453353128899037e-10, 2.2628963692019865e-10, 1.501296050781634e-5, -8.057601916126226e-6, -5.219078851358755e-7, 2.5929178257193136e-7, -3.822435313575956e-6, 1.1243875596770462e-6, 1.1397220050146384e-6, -7.215780081930003e-7, -4.226469399321804e-6, 1.1107793359382352e-6, -1.719597180407973e-6, 1.7076083272895654e-6, 8.787666363433785e-6, -5.480809135140425e-6, -1.1505929355797247e-7, -6.237223749347714e-7, 9.966738086740324e-6, -5.314212024808648e-6, 2.8535510050894443e-7, -5.605320892884118e-7, 1.001753204640956e-7, -7.471281484689626e-8, -5.8901921030243204e-8, 1.4553317496042345e-7, -3.989239023172499e-7, 2.1291347041474042e-7, -2.280197808596311e-8, 2.2922885455243333e-8, -9.88436106724415e-9, 2.8110922825834235e-9, 3.0844991967497046e-9, -7.720593730462324e-9, 6.252894971142214e-9, -3.0949246585545354e-9, 7.226153383725526e-10, -2.433106213793873e-10, 5.504700650488834e-11, 1.2026562148542274e-10, -1.0271014095632644e-10, 3.4311766195619226e-10, -2.983051971876193e-10, 1.3114429376521852e-10, 3.385608507540489e-11, -3.898431044190612e-12};
    FLOAT *d_x_q1_accum = NULL;
    GPUCHECK(gpuMalloc(&d_x_q1_accum, 1056 * sizeof(FLOAT)));
    GPUCHECK(gpuMemcpy(d_x_q1_accum, x_q1_accum, 1056 * sizeof(FLOAT), gpuMemcpyHostToDevice));
    const FLOAT x_q2_accum[1056] = {0.0013996067993151946, 0.0037223258022143547, 3.0149489778602914e-6, -0.0003924338593407656, -0.00139881164638059, -0.0037218319347858777, 0.00029688024355998275, -0.00012387843564807361, 0.0053586565220015495, -0.002336020251874505, -0.0017647511857792572, 0.0006636044793605397, -0.005358982303475363, 0.002337460820705655, 0.0002979203259246471, -0.0001243230017253831, -0.00032735805501029073, -0.0008536422370493366, -0.0006409551113015961, -0.001402844189120295, -0.003189581563889889, -0.007105324464710341, 0.0017490943647821419, 0.0038536339097253822, 0.0031917632806407856, 0.00710684989518942, -0.000642150575434439, -0.0014040235330042702, 0.00032730373320186796, 0.0008527989253219641, -0.00039746144558866416, 0.000218708397821455, -0.001343812385008399, 0.0007572240898868613, -0.002375523402856802, 0.0009735453596737092, -0.00830105105359959, 0.0035300198563352793, 0.005504270648445198, -0.0024434808910925557, 0.008304473842171579, -0.0035283648594680974, -0.0023768277808935926, 0.0009736840555147519, 0.0013434369070352008, -0.000755769531381944, -0.0003985094214194749, 0.00021966287587151033, -0.0003376494990527408, -0.0006209617474345172, 0.0005543291409964598, 0.0010455309387171893, 0.0010307882169859292, 0.0015747203275457468, 0.000863136584944937, 0.0025491552235259686, 0.0031548065078024065, 0.008118675150397091, -0.0022933359962368878, -0.005796383915889137, -0.0031496530963251463, -0.0081220985434276, 0.0008613833367183531, 0.0025500028711883758, -0.001029100491914088, -0.0015754667630445778, 0.000554977045177433, 0.001046533602060844, 0.00033817653957457104, 0.0006222847075186232, -0.0004651167333514807, 0.00017881506788408532, -0.001245811702061764, 0.0005542647046740958, 0.0015104224739702357, -0.0007393356554718912, 0.0015326882879481288, -0.000961302081025628, 0.0020101903830014025, -0.0005333313910121482, 0.006485850202487049, -0.0022773205006578266, -0.004814422089186273, 0.001612402844837795, -0.006487777489560288, 0.0022713402240210085, 0.0020103693259446013, -0.0005297648026253893, -0.001533744055079598, 0.0009609336815459689, 0.0015109859644398167, -0.0007390774848176094, 0.0012474974928392065, -0.0005539806380938396, -0.0004647742893561629, 0.00017816140126268037, 0.00020250405928687695, 0.00021972060587645303, 0.00018040079982764427, 0.000607583708503425, 0.0006073866780938236, 0.0015476530381898297, -0.0006277793394343263, -0.001465278537329744, -0.0006492906651583038, -0.0012383094714462388, -0.00029450990560784147, -0.0012765268966931002, -0.0013425186789272432, -0.0042441526347541106, 0.00095851229324924, 0.003320606852850716, 0.0013385100673220102, 0.004244398809043396, -0.0002912110857313263, -0.0012762625959926656, 0.0006506345570556016, 0.0012385864919235254, -0.0006276598751193336, -0.0014655283474245338, -0.0006060342927715097, -0.0015485652953180354, 0.00017928563191885958, 0.0006074149980481404, -0.00020259106430375016, -0.00022037301685028324, 0.00032379210789187625, -0.0001903321480346814, 0.00029566728976579816, -0.000246755466057033, 0.000504891017816521, -0.00011182687139568568, 0.0013421651265381402, -0.0004971067396992129, -0.0010408329754530944, 0.0003646566022499539, -0.0008074576239307942, 0.0003366479194346697, -0.0007036863377497174, 0.00018950743325440653, -0.0023595257197550797, 0.000675526283226374, 0.001977316677767905, -0.0005441291993777816, 0.002359311000296609, -0.0006729021190039166, -0.0007035574923332705, 0.00018741143419038212, 0.0008072163962961514, -0.0003382267683169182, -0.0010407815013579414, 0.00036469670796060243, -0.001342685483808854, 0.0004960489263249868, 0.0005050280978274703, -0.0001105850564908916, -0.00029609214447992496, 0.00024703416189608755, 0.00032385562854516433, -0.00019021135512234166, 0.00016564482839039805, 0.00027918223444741797, -0.00021199227963796327, -0.000397003068547248, -0.00015907103464826326, -0.00021786377391170477, -7.271052006805015e-5, -0.0003212748765754269, -0.00030661346634908236, -0.0008442443419401603, 0.00016817470642019507, 0.0005926221622718225, 0.00015587951883470696, 0.00042707275157490894, 0.00010273509584786741, 0.00033548549486146724, 0.0003140983323994545, 0.00118902850931244, -0.000274774185723219, -0.001023401798076024, -0.0003121419184058961, -0.0011891354731694867, 0.00010150131810979288, 0.0003354932313197412, -0.00015677763435541212, -0.00042699145703904186, 0.0001683189364316601, 0.0005925351040985564, 0.00030611708860418807, 0.0008444067848103399, -7.187930981435899e-5, -0.0003214938086352438, 0.00015958698176500775, 0.00021775956185052188, -0.0002118505697783168, -0.00039704503164098937, -0.00016552024602942746, -0.00027933265271192474, 7.49572755562239e-5, -4.0048841141622846e-5, 0.0003325964574114914, -0.00017477209221145992, -0.0002646725484043879, 0.00011968162225793716, -8.111686457212095e-5, 4.586008391119166e-5, -0.0001782230003972623, 6.354481233575189e-5, -0.0004041034115071296, 0.00013562291139927645, 0.0003085920121984281, -8.928555903929365e-5, 0.00020797031340375673, -7.777751632931872e-5, 0.00011904532646233988, -1.3964567905755805e-5, 0.0005485389003607378, -0.00013533587423309872, -0.00044527392183168547, 8.672996192657964e-5, -0.0005487144942899003, 0.00013411328461469983, 0.00011912100366412928, -1.3079643939977175e-5, -0.0002078955998001296, 7.818981876954982e-5, 0.0003085504569796698, -8.92680497151059e-5, 0.000404228664722839, -0.0001354414618171117, -0.00017838086791223073, 6.318052363672694e-5, 8.0889281318972e-5, -4.63041335098634e-5, -0.0002646748251572536, 0.00011964093974017444, -0.0003328412700683486, 0.00017453772388640183, 7.517701652768798e-5, -3.99007161031797e-5, -1.8057707666975543e-6, 2.7260150414014585e-6, -4.007697317859607e-5, -8.619139459191568e-5, -8.685938850574879e-5, -0.00020773405470031703, 2.8880221309602732e-5, 9.366445832535852e-5, -2.568467032201005e-6, 5.1599083206097935e-6, 3.615381466377064e-5, 8.431550281836635e-5, 4.088974859762039e-5, 0.0001734968388227338, -4.923233064537286e-5, -0.00015081236706257343, -3.441017214987238e-5, -0.00011177899738400184, 1.4202426029392026e-5, -2.9056748435092535e-5, -4.289450356363367e-5, -0.00020005055916449271, 1.0788910441889962e-5, 0.0001653698463045847, 4.249667718153427e-5, 0.00020000068085394122, 1.4736934946870079e-5, -2.9099232922095084e-5, 3.482674118401235e-5, 0.00011166594152109451, -4.9174779047947735e-5, -0.00015078075463705498, -4.059946640606116e-5, -0.00017365322100716565, 3.598125146625352e-5, 8.441252093526232e-5, 2.355514430660146e-6, -5.042477489342958e-6, 2.8900041189420348e-5, 9.365305732343828e-5, 8.668587566941903e-5, 0.00020791328664126972, -3.9908438428306136e-5, -8.644342653187212e-5, 1.9071556173499732e-6, -2.8421792491677295e-6, -1.1740913197216702e-5, 7.736792272791504e-6, 2.468604833730425e-6, 2.2826960651534186e-6, -4.935677828907718e-5, 1.7018061079534716e-5, -6.0605161708098457e-5, 1.264325889472596e-5, 1.6991540226340747e-5, -3.140187316167466e-6, 6.516975968869297e-6, -4.4935333418484475e-6, 2.321913239810834e-5, 2.3626601769449193e-6, 8.103232326534237e-5, -1.4038786977540987e-5, -5.13040941687272e-5, 8.087458155459066e-6, -5.165799379848428e-5, 7.007389374804686e-6, -1.9255282607927316e-5, 1.0608627469598162e-5, -5.050604746783276e-5, 7.197734305936795e-6, 6.933643099184145e-5, -1.9888695109625624e-5, 5.040244525217039e-5, -7.163515750435251e-6, -1.9297304804695103e-5, 1.0477825617133464e-5, 5.153656284689103e-5, -7.329591651989512e-6, -5.1279488710106666e-5, 8.105072636201573e-6, -8.110447779256386e-5, 1.3801314322971282e-5, 2.3318146205708174e-5, 2.512902181443268e-6, -6.510919224395523e-6, 4.574295978191589e-6, 1.6980097650657403e-5, -3.1483638171845813e-6, 6.0694691726692065e-5, -1.2570578789032181e-5, -4.949118571789036e-5, 1.6919238714242318e-5, -2.5941929655096554e-6, -2.397359973236126e-6, -1.1746812605833946e-5, 7.723939208623936e-6, -5.2742179710822345e-6, -8.385236263901466e-6, 7.881659193557629e-6, 1.3415597118133496e-5, 1.3891595498154927e-6, -8.964190511142323e-7, -1.3739975584121787e-8, 1.0120714495825624e-5, 7.725571064050048e-7, 4.408871362983022e-6, -1.0001822328449089e-5, -1.635270350380566e-5, -1.2147247597042269e-5, -2.0332831865690536e-5, 1.106249992738197e-5, 1.4498372481970399e-7, -1.1564252336486234e-5, -2.91859091329122e-5, -8.389294020169465e-6, 5.837646879326818e-6, 4.935463259871083e-7, 5.5269938860567705e-6, 1.8066488029026777e-5, 1.7335519717426443e-5, 6.021819692785403e-6, 2.7405728128443667e-5, -2.32641438031215e-5, -3.426460389602399e-5, -5.882876462809936e-6, -2.7473539817650347e-5, 1.8096017417270853e-5, 1.736992642532198e-5, -5.278414616120683e-7, -5.509173094561155e-6, -8.330268634906776e-6, 5.827606017486693e-6, 1.1546243079442362e-5, 2.9185136044525393e-5, 1.1158226084252455e-5, 7.290771837437841e-8, 1.2214223090347735e-5, 2.0280857025665803e-5, -9.99044155320558e-6, -1.6350939832303098e-5, -7.459886523562009e-7, -4.44387608974884e-6, -4.438677880151345e-8, 1.0161636954071208e-5, -1.4569591595210519e-6, 9.569096215035587e-7, 7.872217229250831e-6, 1.3419649496429924e-5, 5.241928697235578e-6, 8.420450541890763e-6, -1.5878487345112983e-6, 8.739220963169937e-7, -9.48927429292381e-6, 5.334886501050226e-6, 7.191785676829235e-6, -3.278754446433188e-6, -9.5688213820742e-8, -1.6123503048533172e-7, -1.6975499111179285e-6, 4.857082627558265e-7, 1.1573770821831561e-5, -1.0436877885774463e-5, -1.6619373153820433e-5, 6.464851115650277e-6, -7.954090713013863e-6, 2.1367528822495914e-6, -4.90757450238768e-6, 5.74040909006275e-6, -1.0001402121941863e-7, 4.751455973964121e-6, 6.649779380672768e-6, -3.7449162533965617e-6, -5.8637241651642005e-6, -3.7584021590035772e-6, -1.7024716292108982e-6, 5.4317213683527965e-6, 2.4960582810814896e-5, -6.953809596742566e-6, -4.365297393174636e-6, -4.544694737913573e-6, -2.506560265019199e-5, 6.776934230995574e-6, -1.6884845438399462e-6, 5.495904219659987e-6, 5.8346341750099645e-6, 3.6755288081511896e-6, 6.655235155828471e-6, -3.7378879664741513e-6, 1.0330944726308292e-7, -4.821594351453555e-6, -4.917254643362014e-6, 5.73897289822112e-6, 7.883768533578373e-6, -2.1887290269276323e-6, -1.662063348278012e-5, 6.462521539375948e-6, -1.1593822763297904e-5, 1.0420005994897438e-5, -1.6757298043382804e-6, 4.942386422962702e-7, 1.1057839880353446e-7, 1.7705005453539285e-7, 7.191436470212716e-6, -3.2779079381073684e-6, 9.523513092794137e-6, -5.303223959125456e-6, -1.6077300586441858e-6, 8.635423714764572e-7, -5.189183029855078e-8, -2.1150778737326986e-7, 8.880160262979638e-7, 1.790673933776118e-6, 2.1375895723726233e-6, 4.948525540085107e-6, 3.1513727648510325e-7, -6.66032754272586e-7, 2.9283121539540686e-7, 2.875016929063008e-7, -2.901701376686862e-6, -2.7187776069487273e-6, -4.179001046261597e-6, -1.26426545722087e-5, -3.6724646261269137e-6, 9.05048969889387e-8, -5.710463943579748e-6, -8.509806481469146e-6, 9.9747238638283e-6, 7.981158568831382e-6, -3.341849222221689e-6, -2.9370162335584987e-7, -9.738405355010997e-6, -1.1324078694257842e-5, -2.138345153718159e-6, -6.664932154376263e-6, 1.3727769713266963e-5, 9.93501454774814e-6, 8.164040545952075e-7, 5.047211950131974e-7, -1.5308078273416563e-5, -7.9219671717405e-6, -7.954734299465734e-7, -5.332827856561674e-7, 1.3820411662217423e-5, 9.933756370238223e-6, 2.1815048913794422e-6, 6.650610322346503e-6, -9.694297170280853e-6, -1.1328686910167816e-5, 3.3738884248107032e-6, 2.692965554235109e-7, 9.998540450687522e-6, 7.965470995719755e-6, 5.705090621318199e-6, 8.513236042341946e-6, -3.6641269088856754e-6, 8.89820924307393e-8, 4.164546978635175e-6, 1.2655757270766568e-5, -2.8897666759447884e-6, -2.74198971966424e-6, -2.9001308924900664e-7, -2.944129884633376e-7, 3.1272351148887924e-7, -6.64471633749828e-7, -2.125994422297574e-6, -4.960807687424147e-6, 8.773848457673215e-7, 1.8095026507790732e-6, 4.7523774582382926e-8, 2.1868144295028715e-7, 5.520198447177046e-8, -5.487040626190312e-8, -2.458382807595857e-7, 6.896498185747847e-8, 9.173712411880721e-7, -3.5325766967945324e-7, 3.1659239347322397e-7, 3.1278092820241467e-7, 9.633055430016562e-7, -4.2751286775722725e-7, 2.9464677178414345e-7, -1.9327572793849478e-8, -3.1851719017388796e-6, 8.052783130452908e-7, 2.0362412182581145e-6, -5.711770891454231e-6, -6.875009935126638e-6, 2.8993888781792544e-6, -4.765645134932786e-6, 1.08667654410713e-6, -1.2129552920924512e-6, 3.5451228461827196e-6, 6.448012716531391e-6, 2.560221365514372e-6, 3.876273099866318e-7, -1.8986380604018514e-6, -8.563570511259099e-6, -2.023272443562639e-6, -2.2221588458824273e-6, 3.952136302471393e-6, 1.349873348543984e-5, -4.350701820111777e-6, 2.27196570685412e-6, -4.180806871120317e-6, -1.3571892504335998e-5, 4.243437763414795e-6, -2.224391247350119e-6, 3.971969460356553e-6, 8.526859148470424e-6, 1.9282043456129838e-6, 3.921578033516946e-7, -1.8915370732042698e-6, -6.4613433648102154e-6, -2.6335796567804134e-6, -1.2033231072064245e-6, 3.5634608935024246e-6, 4.730088974064255e-6, -1.102449662261971e-6, -6.876090903148256e-6, 2.8981620733669694e-6, -2.0331785386115075e-6, 5.715460027994355e-6, -3.1912659709798505e-6, 7.982802199920526e-7, -3.0538674208757913e-7, 1.1597803171959754e-8, 9.628412718328166e-7, -4.2797428603907773e-7, -3.1520401234914477e-7, -3.1125970644342687e-7, 9.237483839345787e-7, -3.490126141537366e-7, 2.5253979828481363e-7, -6.429025571331262e-8, 5.547979731762528e-8, -5.4120746529382546e-8, 2.933440074319714e-8, 4.5648251522482384e-8, -5.065796053366898e-8, -5.785051221224856e-8, 4.3977477803980745e-8, 1.3200508933550777e-7, 6.204220896861868e-8, -3.6056177447523765e-8, 3.2404939407698975e-7, 7.253889256224393e-7, 5.022734022744022e-7, 3.1091669148114356e-7, 2.045240788103306e-7, 1.3318605762952757e-7, -1.8992515007709637e-6, -1.0933265906053466e-6, -2.006159958773058e-6, -6.059439018150203e-6, -3.0870347643449556e-6, -9.548789422870087e-7, -3.913111083404415e-6, -6.044556679902626e-6, 7.859634047826758e-6, 5.762633276284454e-6, -2.5077113910666014e-6, -1.6278893694885085e-6, -7.522854614468396e-6, -7.661575090280552e-6, -1.1502570679799399e-6, -3.6307221022793897e-6, 1.107923395308793e-5, 8.40105307823863e-6, 8.840126923385669e-7, 2.1419616522294343e-6, -1.2708625173893644e-5, -8.186204274386549e-6, -8.578926504693306e-7, -2.166420217530479e-6, 1.1145455274618512e-5, 8.408272474383888e-6, 1.1706348080825164e-6, 3.6248901476294308e-6, -7.489046269701067e-6, -7.664102316756499e-6, 2.52318694901323e-6, 1.6151138277628763e-6, 7.886778955709543e-6, 5.7437852721255895e-6, 3.918050101602604e-6, 6.038380181052649e-6, -3.0811548867546084e-6, -9.554266411965474e-7, 2.0038405109225874e-6, 6.0609925477948915e-6, -1.8969438275087888e-6, -1.101483497768004e-6, -2.0914564042480354e-7, -1.3058130628217187e-7, 5.003282996894613e-7, 3.1201123640775376e-7, -3.239137634093103e-7, -7.248972723158182e-7, 6.156056236018322e-8, -3.460302864814169e-8, -4.191208984406893e-8, -1.342829917767211e-7, -5.003935959846985e-8, -5.804097603631519e-8, -2.83921279315256e-8, -4.658863340790375e-8, 7.523416558917973e-9, -2.9043197473754768e-9, 4.760145670444489e-8, -2.7861367438175863e-8, -2.4517035765317622e-8, 1.4492093006272489e-8, 7.75088957442198e-9, -4.532244527724468e-9, 1.4960087033526493e-7, -6.406155164701785e-8, -2.4739994784805306e-7, 3.5702549157326244e-7, 6.66805810591341e-7, -2.7399272705895066e-7, 2.458628328615569e-7, -5.848436854917592e-8, -1.7030958428091183e-6, 4.1945091741269436e-7, 2.0416568813507954e-6, -4.477212229277473e-6, -4.773754858457174e-6, 1.9195562626448984e-6, -4.056526429290858e-6, 9.90107042751103e-7, -9.919825829256932e-7, 2.506720554181164e-6, 4.6105471050745756e-6, 2.2143981843497286e-6, 7.559270176036159e-7, -1.5158381484860693e-6, -6.6511430230149455e-6, -1.7256450916156295e-6, -1.5869064096588674e-6, 2.909022205904221e-6, 1.147839650596712e-5, -3.5582942098191935e-6, 1.2942311271974287e-6, -3.0765116927276625e-6, -1.1538458913830557e-5, 3.466753962989403e-6, -1.5863945562572379e-6, 2.9274419093710686e-6, 6.6219493497512245e-6, 1.6537759348234493e-6, 7.598911451364546e-7, -1.510561304642795e-6, -4.618044020975906e-6, -2.270793456993194e-6, -9.881335498384766e-7, 2.5160305987597017e-6, 4.0246786595047405e-6, -1.0056978097108236e-6, -4.77429809190246e-6, 1.919513530618644e-6, -2.0423292535659676e-6, 4.477488562408529e-6, -1.7036954212674946e-6, 4.168482018112566e-7, -2.5045929315207144e-7, 5.5817400342892143e-8, 6.665915715699004e-7, -2.741232361919969e-7, 2.5118608179964086e-7, -3.5368618173664343e-7, 1.4970485642401104e-7, -6.369248124381183e-8, -7.138631053958753e-9, 4.642356824117017e-9, -2.4507387770618707e-8, 1.4410243954575358e-8, -4.8453991595297904e-8, 2.6981861386463816e-8, 7.875031095790661e-9, -2.7341609314246914e-9, -1.19805937314057e-10, 7.334566909610768e-10, -2.8306707245524795e-9, -8.156231934067592e-9, -8.40006355316361e-9, -1.9165209775126693e-8, -7.15517217705619e-9, -3.2415261210412183e-9, 1.2618062686255996e-8, 2.419182507659921e-8, 5.728446397530047e-8, 4.72090363094339e-8, 1.8876862212340086e-7, 4.683660793649596e-7, 3.3356994914613755e-7, 1.5109206873513094e-7, 1.1185684859562213e-7, 8.218409554418565e-8, -1.4599017594413642e-6, -9.029993705918621e-7, -1.2837621095826153e-6, -4.081084971456932e-6, -2.4110891211223043e-6, -6.223939718700725e-7, -2.689382758484853e-6, -4.172827727137162e-6, 6.3902457970909496e-6, 4.766162645397098e-6, -1.7463570701470981e-6, -9.210626706270549e-7, -6.1755724455510175e-6, -6.408432020338914e-6, -8.071999759440257e-7, -2.703246663568099e-6, 9.109820254584365e-6, 6.951105762144905e-6, 6.564130400404927e-7, 1.549933194985541e-6, -1.0499428258680316e-5, -6.686864171760874e-6, -6.382735606537954e-7, -1.5680845899658934e-6, 9.164990328216574e-6, 6.9548313799814565e-6, 8.238088242501215e-7, 2.6989599514485196e-6, -6.147749875448472e-6, -6.411012911564928e-6, 1.7583673102085244e-6, 9.11475957922964e-7, 6.409396164407954e-6, 4.751967924918949e-6, 2.6922294829170972e-6, 4.169909555778868e-6, -2.405927213689881e-6, -6.228482798162705e-7, 1.2820420389414826e-6, 4.082929238528161e-6, -1.457220444823885e-6, -9.102886502697659e-7, -1.1382069605966339e-7, -8.149553583497045e-8, 3.3223721280411555e-7, 1.5188498283143973e-7, -1.8798751661831247e-7, -4.688627297434178e-7, 5.6366096033984875e-8, 4.933467175880025e-8, -1.2370145518427502e-8, -2.4305670686734546e-8, -6.997375648154566e-9, -3.3141497526184267e-9, 8.139425717840277e-9, 1.9390498347273433e-8, -2.661398111426278e-9, -8.480813852689415e-9, 1.7097109665306472e-10, -8.321142781308495e-10, -2.448324357860137e-10, 3.924802417546251e-10, 9.744637692649756e-10, -5.221846323667691e-10, -3.77981197591405e-9, 8.380799926562697e-10, 4.542999107201001e-9, -4.517865536776137e-9, -4.574545247993837e-9, 1.5189953843571552e-9, -2.8422587180727272e-9, -4.349192773235314e-9, 8.984804694328411e-8, -3.426950299065282e-8, -1.4047194276597967e-7, 2.4526558594112666e-7, 3.8978688183013455e-7, -1.5469333368634136e-7, 1.977877879483653e-7, -4.3485509057641904e-8, -1.124813327660716e-6, 2.5957088306285955e-7, 1.576055123121751e-6, -3.545026833275219e-6, -3.2983821242369346e-6, 1.3022761781240857e-6, -3.34987757652309e-6, 8.289201906016759e-7, -7.179231433713057e-7, 1.8425780325427858e-6, 3.788043950765057e-6, 1.8561697335565918e-6, 6.037203659627304e-7, -1.1677588630137652e-6, -5.525925090866263e-6, -1.4241157437633896e-6, -1.2142446978490006e-6, 2.2008755216113575e-6, 9.479450265399713e-6, -2.909056364423233e-6, 1.0286017774832376e-6, -2.3677148096953916e-6, -9.530736199116575e-6, 2.8337174170243497e-6, -1.2140797383799196e-6, 2.213918430221784e-6, 5.5025305559449095e-6, 1.3639752328489573e-6, 6.066024551660167e-7, -1.1642128312304119e-6, -3.7946301238291438e-6, -1.9029327562678232e-6, -7.146996468803606e-7, 1.8496217978573975e-6, 3.3250316961206837e-6, -8.413957245731095e-7, -3.2987284220237184e-6, 1.301740145972606e-6, -1.5764511832392221e-6, 3.545710425842985e-6, -1.1257574430300184e-6, 2.5754160673118395e-7, -2.017061729785935e-7, 4.123056494896652e-8, 3.896469004628222e-7, -1.5479783654787152e-7, 1.4291047241335286e-7, -2.4318260270177267e-7, 9.019661476800995e-8, -3.388070782221726e-8, 3.59725239496229e-9, 4.664827474721558e-9, -4.563084967054452e-9, 1.516331743961907e-9, -4.676372336856634e-9, 4.3883351679364755e-9, -3.870612991758528e-9, 7.76327982707064e-10, -1.0661388491689484e-9, 4.6823731226716e-10, -2.467742403485539e-10, 3.8490994126035014e-10, -2.2403877803787783e-10, 2.5217388022973653e-10, 4.357427578056055e-10, 2.8721978447841515e-10, -1.2004632097854645e-9, -8.120906012760204e-10, -6.310324647606247e-10, -1.5070313911454538e-10, -2.3009813702680005e-9, -5.0802560417363106e-9, -6.0433953957188955e-9, -3.5391422223144875e-9, 5.228541763414031e-9, 1.3232063102005047e-8, 4.0290957468578556e-8, 2.949512530919624e-8, 1.0899001962214503e-7, 2.774394157403986e-7, 2.5633526086180127e-7, 1.1440016315305598e-7, 7.633637106020416e-8, 5.831378984322517e-8, -1.1616961579347008e-6, -7.183373888413746e-7, -8.636956219783785e-7, -2.833476113736703e-6, -1.95737851471373e-6, -4.854381394388474e-7, -1.9486761990445914e-6, -3.037159647176283e-6, 5.297722374524246e-6, 3.9718793746201145e-6, -1.2795772534470523e-6, -6.221019988978626e-7, -5.142472056692693e-6, -5.3530926489840465e-6, -5.760858137654519e-7, -2.014996054259995e-6, 7.614716192363734e-6, 5.8485699397988085e-6, 5.109097451024546e-7, 1.2278707441219572e-6, -8.8234419738987e-6, -5.643211440388282e-6, -4.975238241151227e-7, -1.2416265731201788e-6, 7.660577858796437e-6, 5.852596580064137e-6, 5.875995092126782e-7, 2.0110398389202765e-6, -5.118830843897831e-6, -5.35560903455579e-6, 1.2884570114727876e-6, 6.147442427299486e-7, 5.313710449062017e-6, 3.959506727297971e-6, 1.9510652765276826e-6, 3.034742148815873e-6, -1.953499455340517e-6, -4.856351749163422e-7, 8.618721751747497e-7, 2.834834816112831e-6, -1.1596223039268404e-6, -7.242057485417553e-7, -7.772572800572675e-8, -5.780286669429797e-8, 2.5529528535753945e-7, 1.1502706424917717e-7, -1.0857808988416782e-7, -2.7763049509669006e-7, 3.973009491813035e-8, 3.091601699567596e-8, -5.020187297219457e-9, -1.3375518644420855e-8, -5.932200801523072e-9, -3.5899941149394716e-9, 2.2626202926503306e-9, 5.0974942821087266e-9, -6.127132859035273e-10, -2.0091788582275525e-10, 1.1779517059261756e-9, 8.375683376019976e-10, 4.2934267484693577e-10, 2.8863031313600316e-10, 2.1673257424452272e-10, -2.446127784976208e-10, -2.542061688407568e-11, -2.623515952756279e-13, -2.0369230347020447e-10, 6.38546919706623e-11, 8.257027154827885e-11, -1.1089703552551442e-10, -8.046236020137343e-11, 1.7396026373182296e-10, -7.751668055732033e-10, 2.1307442846256195e-10, 4.7347758224312915e-9, -2.939906785844734e-9, -3.6306614720726914e-9, 1.7360029891959458e-9, 1.35127841761075e-10, -3.1079579631589077e-9, 5.217385124066735e-8, -1.736701399997124e-8, -1.8248335758789966e-7, 1.7476845630968131e-7, 2.40190398250735e-7, -8.951989401463875e-8, 1.3597836796532455e-7, -1.1455296559560444e-7, -1.061021682796498e-6, 2.8015145846610966e-7, 2.3555571377225375e-6, -3.7494798369141548e-6, -3.623855074122092e-6, 1.4637396332227836e-6, -4.283856001021099e-6, 1.0765417736629447e-6, -8.106172506565702e-7, 1.749094801499486e-6, -6.639726184670539e-7, 8.337572681397677e-6, 1.4666014774031435e-6, -1.1149543765969782e-6, -2.367660023995982e-7, -5.520146320053989e-6, -9.807241975046501e-7, 8.001655105737377e-7, 7.2105895995104925e-6, -1.0144259036441355e-5, -4.648878249159802e-7, 1.0847895081832478e-7, -7.251457730764174e-6, 1.0136040045112789e-5, -9.804416272725266e-7, 8.113104166691659e-7, 2.4425276049284685e-7, 5.483725455856353e-6, 1.4706970998660322e-6, -1.1102720617414248e-6, 6.85704102557769e-7, -8.368821903920354e-6, -8.112609932657172e-7, 1.753748360446997e-6, 4.261269957955351e-6, -1.1035548215888232e-6, -3.6237238525010186e-6, 1.4649318241094891e-6, -2.353657739741939e-6, 3.7416241989405367e-6, -1.061874850095592e-6, 2.788804441494102e-7, -1.3837205321592384e-7, 1.1012211288749732e-7, 2.3995207755557107e-7, -8.974743437996628e-8, 1.8486087598475645e-7, -1.7123197179844183e-7, 5.249371364355522e-8, -1.70623594879858e-8, 3.6052081953877634e-10, 3.514430089061826e-9, -3.6148776523107815e-9, 1.732967623280941e-9, -4.8572421133838645e-9, 2.7539744621399698e-9, -7.953057344231384e-10, 1.9609171286663899e-10, 6.632245504510392e-11, -1.8358565414643888e-10, 8.161002600980345e-11, -1.0953294149557574e-10, 2.095689927634593e-10, -5.1964621827251355e-11, -2.899257892918098e-11, -1.608377524597148e-12};
    FLOAT *d_x_q2_accum = NULL;
    GPUCHECK(gpuMalloc(&d_x_q2_accum, 1056 * sizeof(FLOAT)));
    GPUCHECK(gpuMemcpy(d_x_q2_accum, x_q2_accum, 1056 * sizeof(FLOAT), gpuMemcpyHostToDevice));
    const int8_t x_m_accum[528] = {-1, 0, 1, -2, -1, 0, 1, 2, -3, -2, -1, 0, 1, 2, 3, -4, -3, -2, -1, 0, 1, 2, 3, 4, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22};
    int8_t *d_x_m_accum = NULL;
    GPUCHECK(gpuMalloc(&d_x_m_accum, 528 * sizeof(int8_t)));
    GPUCHECK(gpuMemcpy(d_x_m_accum, x_m_accum, 528 * sizeof(int8_t), gpuMemcpyHostToDevice));
    const int8_t x_n_accum[528] = {1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22};
    int8_t *d_x_n_accum = NULL;
    GPUCHECK(gpuMalloc(&d_x_n_accum, 528 * sizeof(int8_t)));
    GPUCHECK(gpuMemcpy(d_x_n_accum, x_n_accum, 528 * sizeof(int8_t), gpuMemcpyHostToDevice));
    const int8_t x_m_signs[528] = {1, 1, -1, 1, 1, 1, -1, 1, 1, 1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1};
    int8_t *d_x_m_signs = NULL;
    GPUCHECK(gpuMalloc(&d_x_m_signs, 528 * sizeof(int8_t)));
    GPUCHECK(gpuMemcpy(d_x_m_signs, x_m_signs, 528 * sizeof(int8_t), gpuMemcpyHostToDevice));
    const int8_t x_m_abs_m[528] = {1, 0, 1, 2, 1, 0, 1, 2, 3, 2, 1, 0, 1, 2, 3, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22};
    int8_t *d_x_m_abs_m = NULL;
    GPUCHECK(gpuMalloc(&d_x_m_abs_m, 528 * sizeof(int8_t)));
    GPUCHECK(gpuMemcpy(d_x_m_abs_m, x_m_abs_m, 528 * sizeof(int8_t), gpuMemcpyHostToDevice));
    const int32_t x_lengths[1] = {528};
    int32_t *d_x_lengths = NULL;
    GPUCHECK(gpuMalloc(&d_x_lengths, 1 * sizeof(int32_t)));
    GPUCHECK(gpuMemcpy(d_x_lengths, x_lengths, 1 * sizeof(int32_t), gpuMemcpyHostToDevice));
    const int32_t x_offsets[1] = {0};
    int32_t *d_x_offsets = NULL;
    GPUCHECK(gpuMalloc(&d_x_offsets, 1 * sizeof(int32_t)));
    GPUCHECK(gpuMemcpy(d_x_offsets, x_offsets, 1 * sizeof(int32_t), gpuMemcpyHostToDevice));
    const FLOAT y_q1_accum[1056] = {-0.004162448638243989, 0.0014878352950210257, -0.00028964885934452717, 0.0004341985073740066, 0.004161702641519493, -0.0014891846795087075, -1.6460009072541046e-5, 0.0005941110291066965, 0.0025162992759500775, 0.006146546621757971, -0.00031896666403819494, -0.0013040406076364054, -0.00251649259598571, -0.006143660055606968, -1.839924902570766e-5, 0.0005959966633418996, 3.5376548371514533e-6, -0.00022298156264323655, 0.0021648492473124873, -0.000925375582468682, 0.008048175661015653, -0.003577652820477719, -0.004308030076353097, 0.001963911096989796, -0.008044936817407512, 0.0035773062147935455, 0.002165343013909426, -0.0009242030714556826, -2.9796927767551583e-6, 0.0002239734333823069, -3.724534719695455e-5, 2.6160650637257118e-5, -0.0003260265146869943, -0.0005069532719992591, -0.0015935664539360943, -0.0031210562866396015, -0.004083742739064085, -0.008976535470693726, 0.003180496623888823, 0.0065971984010853415, 0.00408576744745127, 0.008975154519603463, -0.0015940613433531345, -0.0031196283872182364, 0.00032741513460734324, 0.0005076834175081505, -3.593241514498853e-5, 2.5450915303653205e-5, 0.0005101473919475872, -0.00045311571206827725, -0.0007618462079878687, 0.0004358756107993956, -0.0012086383177389946, 0.00042846234252489257, -0.0026914471819894908, 0.001389190692702441, -0.00817989907787905, 0.0036156600254720482, 0.006666021123606054, -0.003089556664925333, 0.008180696412100685, -0.003620224908616228, -0.0026899813318923614, 0.0013911675751915869, 0.0012110521238735462, -0.0004295110546925075, -0.0007632577964068856, 0.0004348402154530668, -0.0005096260826048592, 0.0004516539738810501, -0.00036266787704308676, -0.00043784098528461024, -0.0007039775648699094, -0.0009497292825815621, 0.0007330864874319223, 0.0014760108999910886, 0.0005181184798932913, 0.0016353517999758455, 0.0007015058044030444, 0.0015304282143849667, 0.0024071986419805166, 0.005946335761855994, -0.002077059917920677, -0.004994566290525423, -0.0024129987534453304, -0.005948127556151194, 0.0007040931277372397, 0.0015297704551363964, -0.0005186678881831782, -0.001637024637807554, 0.0007330211826631776, 0.001477522833498693, 0.0007024671493052235, 0.0009496725993675522, -0.00036304647070650416, -0.0004370949314626111, -0.000127724870590941, -3.930953383817718e-6, -0.00037588001163937776, 0.00033112713658000795, -0.0010726497497199154, 0.0006604796348655439, 0.0014587445029480399, -0.0006352018106450179, 0.0015230101641553085, -0.000493068525849638, 0.0006582556220442847, -0.0002089581725927956, 0.003457980979902323, -0.0011735247462459878, -0.0030466988796929457, 0.0010708834391124833, -0.003459112452060201, 0.0011784209595707973, 0.0006585915793282911, -0.00021127186950115054, -0.0015234956767354467, 0.0004936151683171026, 0.0014599489892820846, -0.0006357609802036222, 0.0010729522132985844, -0.0006604183618549661, -0.0003752399295475325, 0.0003315612559460253, 0.00012845567550633224, 4.002154824950352e-6, 0.00011080405738869261, 0.00020445207256530336, 5.188535753839163e-5, 0.00025237224665409125, 0.00011977921953848123, 0.00011858082960327471, 0.0003965928996131398, 0.000813451241726147, -0.0003113334831027168, -0.0009102838153358835, -0.00032472640118722456, -0.0010302056815584984, -8.302775445576102e-5, -0.00032941561644563174, -0.0004403207207980117, -0.0017145618343193353, 0.0005051465731586249, 0.001677456274896712, 0.00044394871428290246, 0.00171529910777043, -8.488539339457542e-5, -0.00032987252977067236, 0.0003250921445815462, 0.0010299706980196738, -0.0003119537530344933, -0.0009109375951084559, -0.0003973536875717441, -0.0008139651825838364, 0.00012012813484855638, 0.0001185002234223517, -5.1852324424534076e-5, -0.0002529857847432789, 0.00011101855101779839, 0.00020482729167920014, -0.0001613251035581489, 0.00013317395270672096, 0.00022470041274069062, -0.0001140802965844704, 0.00027315924457784607, -8.923522417052736e-5, -9.43966087097443e-6, 1.0733863965476107e-5, 0.0004215206545992265, -0.0001368668279052749, -0.00042994801156359154, 8.937776272980574e-5, -0.0005250950953420007, 0.00012657570892160493, -0.00018979656445749555, 6.804471332634834e-5, -0.0008354513569462005, 0.0001802855489385361, 0.0008492529978522441, -0.00023209852399618116, 0.0008360223172616219, -0.00018266553490148832, -0.00019009736009639782, 6.932462335235507e-5, 0.0005249802315965893, -0.0001267570256521289, -0.0004302472869140906, 8.9825177623782e-5, -0.0004217159707421627, 0.00013760952676098267, -9.237091300175394e-6, 1.0470923301756868e-5, -0.00027328070601426293, 8.930039415249449e-5, 0.00022509138775001695, -0.00011433223699708865, 0.00016123452521333063, -0.0001332770448278294, 4.338318076254139e-5, 4.011877393733713e-5, 0.0001193551981320878, 0.00014053590264666462, -5.211472288375199e-5, -0.0001302077411454886, -6.089428467850034e-5, -0.0001725949921892192, 1.3574225447710172e-6, -2.4263825127497356e-5, -2.1469253874632323e-5, -0.00016550764107199108, 4.5282426920957534e-5, 0.00023838096092213443, 2.219929540554899e-5, 0.00022945725504654893, 7.077412634499127e-6, 3.507466692920705e-5, 9.05218231924682e-5, 0.0004025390594705151, -6.082960853410585e-5, -0.00033565194764080243, -9.190883896114787e-5, -0.00040296318928741706, 7.864788312481608e-6, 3.533983348519832e-5, -2.2192443052746265e-5, -0.00022943173713797516, 4.5553335159047545e-5, 0.0002385620956496418, 2.189964686193457e-5, 0.00016551237404110412, 1.1184558173886404e-6, -2.439594352864947e-5, 6.103175774672925e-5, 0.0001724005948001389, -5.227051100872375e-5, -0.000130349767127284, -0.00011947892966936171, -0.00014042707791414474, 4.342126749149405e-5, 4.006553362790516e-5, 6.493671053684112e-6, -2.721868276933137e-7, 2.8074431024940826e-5, -3.6832262132714456e-5, 3.9080230837826744e-5, -3.210459640804654e-5, -4.3938471779983615e-5, 1.1610272866189613e-6, -5.468454887265044e-5, 7.483604856703839e-6, -4.559821679926304e-5, 2.533779190692452e-5, -8.27408508723925e-5, 1.324128639591412e-5, 0.00014917295190699397, -3.935074473072077e-5, 0.00011121310249718601, -1.1086247949136864e-5, -3.63213819554835e-5, 2.9904128302511658e-5, 0.00013248627654199532, -1.3488115109247394e-5, -8.996473009704042e-5, -1.3394982098214446e-5, -0.00013262203868558516, 1.4177790146413187e-5, -3.6113060538530065e-5, 2.9470926919367745e-5, -0.00011112544346547051, 1.100091653065713e-5, 0.00014927500319419207, -3.954418071910039e-5, 8.279306536725656e-5, -1.3494266924256518e-5, -4.56144287624562e-5, 2.5526252903127584e-5, 5.455534183660089e-5, -7.589987616068833e-6, -4.390396266569113e-5, 1.2705179367116015e-6, -3.900391397696921e-5, 3.219490813887475e-5, 2.802188349055653e-5, -3.689124111725382e-5, -6.349197381209819e-6, 3.5450031464375587e-7, -6.4939237926503075e-6, -9.364030195624603e-6, -1.172924420623686e-6, -8.85024920035208e-6, -6.707324432386587e-6, 2.242346314564011e-6, 1.94467733063805e-5, 1.1943096243413547e-5, -4.977265317767884e-6, 2.0700513482978466e-5, -1.0827955318661068e-5, 9.071346765074129e-6, 3.5016569776872317e-6, -1.5858243246595666e-6, 1.5085412865615402e-5, 5.442336720728546e-5, 6.673946262374957e-7, -3.729030969282983e-5, -1.4985947850450563e-5, -5.22421982005688e-5, -1.0452178348972009e-6, -8.932371061557547e-6, 2.0687875624127835e-5, -1.1094727448480105e-5, 5.2064086604923365e-6, 5.0328712600328615e-5, -2.0418193196995606e-5, 1.1068333219659363e-5, -1.2621415115727904e-6, -9.024066842851553e-6, 1.4939084508813222e-5, 5.209864508059265e-5, 5.656181253439518e-7, -3.72950662965744e-5, -1.5298191768535704e-5, -5.450530084414332e-5, 3.60297451326555e-6, -1.5646297922398203e-6, 1.0808244246156756e-5, -9.076396813693526e-6, -4.896800197851984e-6, 2.0643703404108552e-5, -1.9380670960972465e-5, -1.1984663666511826e-5, -6.7534525273101725e-6, 2.2644565151438753e-6, 1.248427793788143e-6, 8.694699279387554e-6, -6.5770741296001116e-6, -9.261934800398564e-6, 4.695663616046229e-6, -4.613090145273048e-6, -8.085564750901024e-6, 5.55790788125722e-6, -6.601280550302258e-6, 1.481129498936517e-6, 1.1519756152269125e-5, -8.918328907654796e-6, -6.927976350048698e-6, -6.946286312871627e-6, 1.976553582741725e-5, -5.056288756096325e-6, 1.6708507423279257e-5, -3.2376851199287423e-6, -2.6738106490322495e-5, 1.6687027368600223e-5, 1.4352115839130864e-5, 1.530883721506833e-6, 2.2454839758941264e-5, -2.1500704541010602e-5, -8.563587661607118e-6, -2.3377453457047536e-7, -3.8886553433398474e-5, 2.469348831432567e-5, -1.6794660360399957e-5, 1.189715048232674e-6, 4.89109886508464e-5, -2.4384887569288844e-5, 1.683043542292194e-5, -1.3144538919030782e-6, -3.8881321689537776e-5, 2.4799859221187354e-5, 8.534557722025799e-6, 2.448004380580767e-7, 2.248241145662641e-5, -2.1478265799832895e-5, -1.4351176670411213e-5, -1.4040134605543536e-6, -2.6680700856171054e-5, 1.6653958863613392e-5, -1.6709403014130842e-5, 3.2276176879853684e-6, 1.977077869102533e-5, -5.108595468427174e-6, 6.900715352473765e-6, 6.8956557642891965e-6, 1.1515048579553006e-5, -8.893583160354195e-6, 6.53012781285498e-6, -1.5081920133653524e-6, -7.9823135762756e-6, 5.6417666034969085e-6, -4.650022664243987e-6, 4.6539258718265805e-6, -9.888930060818778e-7, -7.122394369380633e-7, -4.095167395737603e-6, -3.778357471991365e-6, 9.006440255188642e-7, 1.7711188217254975e-6, 6.700555223144097e-7, 2.5177434616255275e-6, -2.095372950682165e-6, 5.702390471201058e-7, 1.2535343013052621e-5, 2.1149691247552864e-5, -3.1170522053759026e-6, -5.681955916709478e-6, -9.030715046219619e-6, -1.54044708369935e-5, 1.4228575975387153e-6, -3.2027587163046996e-6, 8.765693867852093e-6, 9.783846644866349e-6, 1.1662391578242342e-6, 4.854005808624425e-6, -9.52161158404624e-6, -5.056213896894645e-6, 3.8223445369225134e-7, -2.6390219359599307e-6, 1.722601008388563e-5, 3.156383660980988e-5, 6.447969575389955e-7, -3.2940794208456208e-6, -1.7311896651431276e-5, -3.163502127251796e-5, 4.266959346725496e-7, -2.635467254763878e-6, 9.537277757156993e-6, 5.008914560010535e-6, 1.1681179339497556e-6, 4.864421578086076e-6, -8.754239944236068e-6, -9.834356005979095e-6, 1.3961064815004455e-6, -3.221665120610022e-6, 9.028266699849399e-6, 1.5358152123069456e-5, -3.129376569569981e-6, -5.697989957064508e-6, -1.2566790002433194e-5, -2.1134880793674668e-5, -2.0851836130263276e-6, 5.744608993922506e-7, -6.638301729643064e-7, -2.515072162557826e-6, 9.341776766012693e-7, 1.7286504276719645e-6, 4.137483791243983e-6, 3.7321114652284674e-6, -9.949985099941272e-7, -7.090534430215051e-7, -1.171844544882845e-7, -1.6883296090307815e-8, -6.15176706842124e-7, 9.620547707983551e-7, -3.927842221748346e-7, 8.482600614156047e-7, -1.421844781157844e-6, 1.6058412863226535e-6, 1.3784665234222027e-7, 2.943615595424428e-7, 6.977857380547815e-6, -5.336110654069268e-6, 1.2780955986638106e-6, -4.052315348302965e-6, 6.464093326675292e-6, -3.841147585997726e-6, 3.4422145361458596e-6, -2.1372574684673184e-6, -2.102668559236937e-5, 1.2865491979231203e-5, 5.465789584015367e-7, 1.0904135493218315e-6, 2.8360727820130654e-5, -1.6051452776154873e-5, 4.3824680309845354e-6, 1.5815147058639134e-7, -2.8835287256518886e-5, 1.8379114158756783e-5, 1.049853770925736e-6, 3.34194173901017e-7, 2.4322011297334272e-5, -1.8438500511140832e-5, -1.0437469237254298e-6, -3.094752933843252e-7, -2.8805707827027354e-5, 1.8361430914396677e-5, -4.382066756825873e-6, -1.7881648777176663e-7, 2.8384553719058047e-5, -1.6068020355870875e-5, -5.432619122517685e-7, -1.08197191327895e-6, -2.100413728861546e-5, 1.2887062394383985e-5, -3.46458483765232e-6, 2.1274552889922457e-6, 6.475765293394758e-6, -3.845662720531298e-6, -1.2754755028701817e-6, 4.0606143983920285e-6, 6.973455424290293e-6, -5.342466173505425e-6, -1.397795710540958e-7, -2.96401470228908e-7, -1.4176014821986661e-6, 1.6097146593860388e-6, 3.736023423924612e-7, -8.663849393047042e-7, -6.119337506072553e-7, 9.689655728187628e-7, 1.0748886503869218e-7, 1.3461783734052224e-8, 4.722026032201812e-8, 1.0286771534799996e-7, -3.641723538740352e-8, 9.737110261199619e-8, 3.1352386811437043e-7, 1.1173969257245394e-7, -1.0349389601571764e-6, -1.0722475911914411e-6, 5.194629744169852e-7, -1.872072056900686e-8, 3.9219045880101506e-7, 6.579702123306412e-10, -1.5376838462349678e-6, 3.520307066234696e-8, 8.278058344811756e-6, 1.2589334685847395e-5, -2.2472078038722994e-6, -1.3360991954077396e-6, -6.869600107704042e-6, -8.692514392874198e-6, 1.262507055899926e-6, -1.8027572353435721e-6, 6.221771531009018e-6, 1.0018584534029944e-5, 9.588417184069883e-7, -6.15705701143911e-8, -6.748389465563878e-6, -7.1568595915852385e-6, 7.278322638521671e-8, -2.1570559136494288e-6, 1.2841352717728093e-5, 1.961229381605896e-5, 5.633047579928586e-7, 1.7559879699508672e-6, -1.2859416150129414e-5, -1.9663311691175675e-5, 6.7958392580975e-8, -2.1655869185998707e-6, 6.745185668460726e-6, 7.114823298091626e-6, 9.482515797243117e-7, -5.475236821016825e-8, -6.2425336446297e-6, -1.0055265182392702e-5, 1.2671194530605746e-6, -1.808745422470547e-6, 6.871985915734069e-6, 8.67204950951564e-6, -2.242596805692306e-6, -1.3517677311697067e-6, -8.27725724772361e-6, -1.2588810870841491e-5, -1.542831356078399e-6, 3.785703940007309e-8, -3.8400282712663e-7, -1.3006894597427946e-8, 5.225118216745224e-7, -2.2882581501535404e-8, 1.0362086397708657e-6, 1.0696516941996122e-6, 3.1727058467523596e-7, 1.1041197338486221e-7, 3.3284541060370605e-8, -8.744278372139287e-8, 5.0281710658557396e-8, 9.787104990120987e-8, -3.8354147246929855e-8, 3.494028276516706e-8, 9.426229049928343e-8, -4.1485821409146696e-8, 1.4875106737055068e-8, 3.848569976957228e-8, -1.5431536734077835e-7, 1.4520808593246205e-7, -2.8911557604889318e-8, 3.786905511668685e-7, -1.293915573431424e-6, 7.878222167117004e-7, -3.49780589880421e-7, 6.897704747483313e-8, 4.655012734022512e-6, -3.288631195597197e-6, 3.092973350218011e-7, -2.6296271504873275e-6, 5.692213144357415e-6, -2.6380374047120317e-6, 3.0531236736362135e-6, -1.3057529337893313e-6, -1.6197483791034537e-5, 9.701279642155106e-6, 1.4223782352126053e-6, 7.358607858018115e-7, 2.0975193834220716e-5, -1.2601672704638918e-5, 2.0441606316167313e-6, 5.228993465517419e-8, -2.295920535979654e-5, 1.4565409568989545e-5, -3.605739305218382e-7, 2.3146999467102572e-7, 2.0919010405525424e-5, -1.4771501935320242e-5, 3.66440372975395e-7, -2.294822460681013e-7, -2.294195947996785e-5, 1.456832209637652e-5, -2.046772978771677e-6, -6.090306989736847e-8, 2.0993411083185193e-5, -1.2610472582403572e-5, -1.4200056314288879e-6, -7.164056723460099e-7, -1.6174962983510016e-5, 9.708604693174642e-6, -3.0644558388984624e-6, 1.298444077012557e-6, 5.698101518474503e-6, -2.649201138289955e-6, -3.10765547302756e-7, 2.6265735473320516e-6, 4.651666261100844e-6, -3.2876791883963676e-6, 3.430559697299959e-7, -7.10543262932505e-8, -1.2847996815879454e-6, 7.956018332318474e-7, 2.597299736208396e-8, -3.807652068143788e-7, -1.5405761780998918e-7, 1.4482977333894042e-7, -1.1161278679654246e-8, -3.761129328200897e-8, 8.918148614099722e-8, -4.4589278396042966e-8, 3.697611744084659e-8, -3.6164139194105945e-8, 1.0303961659260932e-8, 5.676683929916088e-9, 3.506653178336111e-8, 3.66328288031367e-8, -6.926787139754919e-9, -2.383676830117757e-8, 1.8859429732087974e-8, 2.224050611941391e-8, 8.715655102061166e-8, 3.4021555404306923e-8, -5.45076933709193e-7, -7.382366053339384e-7, 2.825095626613175e-7, 1.6644852864157623e-7, 2.0294910732168548e-7, 1.2739412224780952e-7, -9.431375696147264e-7, 4.9778404206051505e-9, 5.905494809381997e-6, 9.537762131535202e-6, -1.5024983297550346e-6, -1.1794425390510305e-6, -5.2266451059498506e-6, -6.9409623365159226e-6, 8.490066060788838e-7, -1.299328637206125e-6, 4.649221073957069e-6, 7.130655317676196e-6, 6.670721786785167e-7, 2.5289436547276756e-7, -5.193996001015607e-6, -5.1578480997459235e-6, 8.515128090998192e-8, -1.530811596364966e-6, 9.997740070931642e-6, 1.5677047465093294e-5, 4.077769059928735e-7, 9.472651237899867e-7, -1.0017441757655607e-5, -1.5716691567837078e-5, 8.665338855659896e-8, -1.5358076188549615e-6, 5.1921975353487795e-6, 5.125592778963793e-6, 6.612596595335918e-7, 2.579910821715923e-7, -4.655495096365318e-6, -7.1519249883361125e-6, 8.488433826826379e-7, -1.304287967274304e-6, 5.226888928707396e-6, 6.921051399045681e-6, -1.5014366968204103e-6, -1.1889660761877035e-6, -5.909897560821551e-6, -9.535506922114807e-6, -9.441385195799699e-7, 6.758537835836418e-9, -1.9783375743963783e-7, -1.3381562489903156e-7, 2.86302348818322e-7, 1.6157348883386252e-7, 5.484257325481588e-7, 7.345588016183065e-7, 8.753627602579375e-8, 3.37070948137852e-8, -1.9447210696463817e-8, -2.1179558369829143e-8, -8.052401879474887e-9, -2.19459763614978e-8, -3.6319585542143624e-8, -3.521827606545251e-8, 1.0456775509446332e-8, 5.64105511285779e-9, 4.878416237996048e-10, 1.1962466485917323e-9, 5.528636598219542e-9, -1.0785066857376963e-8, 1.1201090249364845e-8, -1.2452798763529219e-8, 1.8635144563605434e-8, -1.2832949635574114e-8, -1.6622589319051967e-9, 1.174515522836258e-9, -9.54877173136957e-8, 9.439482474239467e-8, -7.263384999062573e-8, 2.2862724789447444e-7, -8.327809709181186e-7, 5.130307862168398e-7, -1.8742170031176704e-7, 5.972571808794536e-8, 3.4322599567999554e-6, -2.3558235016394734e-6, 3.2730622490799793e-7, -1.8152314349315832e-6, 4.3443939799582235e-6, -1.9915736124713587e-6, 2.100067239656857e-6, -9.375441238988896e-7, -1.2952968084730703e-5, 7.687568209781067e-6, 9.887829629427735e-7, 5.345699232252669e-7, 1.6903415160605652e-5, -1.0103629057450859e-5, 1.5500106091193682e-6, 6.276639811774344e-8, -1.8611644882753638e-5, 1.1750575888900655e-5, -1.3552414954191813e-7, 1.522585197451264e-7, 1.7034021054389094e-5, -1.205601662462601e-5, 1.3984776327607547e-7, -1.4912081135137688e-7, -1.85967570676071e-5, 1.1749576449234425e-5, -1.5517042036904913e-6, -6.989081334790251e-8, 1.6917756294530007e-5, -1.01106247776323e-5, -9.872722242052432e-7, -5.221117466560852e-7, -1.29398467022231e-5, 7.69462704009385e-6, -2.10866282664973e-6, 9.332376231779912e-7, 4.34722934190261e-6, -1.998969230604032e-6, -3.2786175562598454e-7, 1.8146875302356658e-6, 3.4304271332580226e-6, -2.355764640316546e-6, 1.8368842520863573e-7, -6.114690940918033e-8, -8.277251627777005e-7, 5.171867336727753e-7, 7.011587819826276e-8, -2.3082781689564338e-7, -9.524738488983114e-8, 9.473193557075974e-8, 2.544558539068529e-9, -9.188645726608367e-10, 1.803246225154548e-8, -1.3203008752477086e-8, -1.066561130451835e-8, 1.2940154677551076e-8, 5.489932838741438e-9, -1.0950729586280137e-8, -3.4341671311718885e-10, -1.1562568711594882e-9, 5.588723493141503e-12, -5.940018495857662e-10, 1.260510140906575e-9, -4.903771295404429e-10, -4.3204636907220045e-9, -1.6722420669325867e-9, 4.687813007944538e-9, 5.7473128925442445e-9, -4.7811338972126086e-9, -5.899176655817766e-9, 4.15590502555965e-9, 1.860639211355495e-8, 5.8231059880406915e-8, 2.434206717103385e-8, -3.441690418057412e-7, -4.894665388684227e-7, 1.8707048741036225e-7, 1.0649743264616051e-7, 1.529955636170084e-7, 7.922741448200676e-8, -6.597631431047895e-7, -1.9415265876276628e-8, 4.453036709497442e-6, 7.366556363443831e-6, -1.079395669703953e-6, -8.434403728502367e-7, -4.162724311933356e-6, -5.5165301497441265e-6, 6.330637821565687e-7, -9.391547785588818e-7, 3.6253765909268616e-6, 5.522825097590804e-6, 4.923314057797181e-7, 1.572214602132887e-7, -4.1093355365774545e-6, -4.102882801338823e-6, 6.623147277218543e-8, -1.139297070994221e-6, 8.002484074169843e-6, 1.2558579391777873e-5, 3.0757209570560907e-7, 7.431121999516918e-7, -8.01749469684152e-6, -1.2593389772769734e-5, 6.67345371679722e-8, -1.1430918387158944e-6, 4.1075771529073125e-6, 4.076149606756057e-6, 4.878182796908346e-7, 1.6101670122503822e-7, -3.6322625207663695e-6, -5.541563581738763e-6, 6.332713623053944e-7, -9.427246343446536e-7, 4.163128907405003e-6, 5.50469700524795e-6, -1.0785713729375952e-6, -8.503623137254991e-7, -4.457707630598786e-6, -7.363709490875309e-6, -6.607142134893804e-7, -1.826915185721032e-8, -1.4906462354135557e-7, -8.373734834828766e-8, 1.8927658058644045e-7, 1.0356241735669444e-7, 3.45932054669247e-7, 4.873903624102668e-7, 5.865725343254335e-8, 2.413166219787513e-8, -4.512597822720474e-9, -1.7793188841702946e-8, -5.058421706753082e-9, -5.398454931921741e-9, -4.8212410710997434e-9, -5.577079957661331e-9, -4.393434696735395e-9, -1.6568216789033946e-9, -1.2221015296328308e-9, 3.4326227329826047e-10, -2.6327436781715966e-11, -5.377979250816435e-10, 7.552535436138746e-10, -7.15995975949915e-10, -6.796398215397071e-10, -1.217712878586627e-10, -2.3257785300049988e-10, -5.604325180724743e-10, 1.0633828883912176e-9, -1.1045507110511265e-9, 2.779418666711173e-9, -3.6612249903774653e-9, 1.2612673801169248e-8, -6.163458868002357e-9, 9.872365876058935e-10, 2.399555414586727e-9, -6.239755900772906e-8, 5.6749590567027833e-8, -5.0102373265906754e-8, 1.4822190415397885e-7, -6.170888230315267e-7, 3.635833112368537e-7, -1.3244114901357225e-7, 3.89314265131513e-8, 2.6516055979772554e-6, -1.7758698115877876e-6, 2.581061286764348e-7, -1.309194516183896e-6, 3.477105508230353e-6, -1.5530915401981754e-6, 1.5475210209231944e-6, -6.876243178722743e-7, -1.0588686917483955e-5, 6.230479222159605e-6, 7.655253951235756e-7, 3.962575898235173e-7, 1.3840535310081447e-5, -8.281307398673205e-6, 1.1479268075311318e-6, 5.590416309795235e-8, -1.538371298662845e-5, 9.676499433183439e-6, -8.671424003887715e-8, 1.077262207429402e-7, 1.4193820685700624e-5, -1.0009167541338804e-5, 9.019578592171747e-8, -1.0561515088648086e-7, -1.5370920413743462e-5, 9.677431860052933e-6, -1.1491925947980467e-6, -6.123526470145727e-8, 1.3852744967507235e-5, -8.287003593734465e-6, -7.640258393269113e-7, -3.8697984417445195e-7, -1.0577360043990277e-5, 6.23480378325502e-6, -1.5538557089990666e-6, 6.841948125309588e-7, 3.4792784109477876e-6, -1.5594038978960146e-6, -2.58348117980208e-7, 1.308646005021917e-6, 2.6504483534337093e-6, -1.7753704103283898e-6, 1.2980463569371775e-7, -3.986837068664116e-8, -6.135155580665969e-7, 3.6665132954436464e-7, 4.852414711899788e-8, -1.4954138984895842e-7, -6.227095600033318e-8, 5.686980692196727e-8, -3.8877617651289224e-10, -2.2498589303608124e-9, 1.2195796563537756e-8, -6.430097984138119e-9, -2.627838822092912e-9, 3.786329253981498e-9, 1.0589642144305969e-9, -1.1154011563323683e-9, 1.7890691161277978e-10, 5.497951625443565e-10, -6.219191630134643e-10, -8.9389438268288e-11, -7.433990492234908e-10, 7.256000832569639e-10, -7.409596530607862e-11, -3.064120421882442e-11, -1.3330187075372527e-10, -3.100004973972851e-10, -4.1028846037395445e-11, 2.3538781007661105e-10, 1.2745101128024208e-10, -5.759228084644623e-11, -1.5940119559026332e-9, -7.18624079287831e-10, 3.1093305651216592e-9, 6.246860601032545e-9, -1.9189641223040503e-9, -6.527426321034321e-9, 2.8403931072723723e-9, 9.909350806540185e-9, 4.4094045253249896e-8, 2.0902528104770644e-8, -2.134603324403411e-7, -3.9920616378777827e-7, 1.1055466415030998e-7, 1.2570561081064924e-7, -7.476945387944525e-8, -1.005712963348078e-7, -4.826298907552896e-7, -1.4617088891323538e-7, 5.3270593078735e-6, 9.974447402432298e-6, -1.0058960918639106e-6, -8.070876082681336e-7, -5.493866191408394e-6, -8.786586163662112e-6, 3.0175680202361154e-7, -6.708787934895777e-7, -1.1169126307203174e-6, -4.22854164288764e-6, 1.1680291664055276e-6, 5.138445980061354e-7, 1.1283799636847028e-6, 3.825712997912295e-6, -3.123528606783771e-7, -7.638570209491258e-7, 8.077253614680195e-6, 1.5019905450668784e-5, 2.8722523283209346e-8, -2.643261195492861e-7, -8.102527709563674e-6, -1.50239422095242e-5, -3.1193631958772537e-7, -7.646158220932273e-7, -1.1155338606819913e-6, -3.83805332459659e-6, 1.1601087684194687e-6, 5.141285726681111e-7, 1.126135496623729e-6, 4.212041284522326e-6, 3.088778205342161e-7, -6.72056002651946e-7, 5.491057242306391e-6, 8.768651012465398e-6, -1.0072791417217186e-6, -8.136879348359535e-7, -5.336525075542462e-6, -9.975209515087102e-6, -4.851644060028216e-7, -1.4585366793906844e-7, 8.08255485217209e-8, 9.84050907711764e-8, 1.124081597224902e-7, 1.2274516016006038e-7, 2.1607377798545639e-7, 3.975377789601355e-7, 4.464961852232114e-8, 2.0808484387459646e-8, -3.3225741831194516e-9, -9.504456029072226e-9, -2.0876034413298125e-9, -6.097699536805517e-9, -3.2783374161124366e-9, -6.134076018199763e-9, -1.62321282155526e-9, -7.16908702070013e-10, -1.1015581329005263e-10, 4.002380287543965e-11, -3.0084104844327e-11, 2.0776155025982898e-10, 1.512495377520687e-10, 2.987160849891081e-10, -7.566119142244932e-11, -3.073138874197808e-11};
    FLOAT *d_y_q1_accum = NULL;
    GPUCHECK(gpuMalloc(&d_y_q1_accum, 1056 * sizeof(FLOAT)));
    GPUCHECK(gpuMemcpy(d_y_q1_accum, y_q1_accum, 1056 * sizeof(FLOAT), gpuMemcpyHostToDevice));
    const FLOAT y_q2_accum[1056] = {-0.004034296280865082, 0.0015656933334064582, -1.2441775573566387e-6, -3.1459594127791015e-7, -0.004034693878292754, 0.0015665409646035214, -0.0002214837720009396, 0.00011251723046669821, 0.0026438257572426456, 0.0058347942626772, -6.346465057932712e-7, 6.642169720553863e-7, 0.0026414689874897455, 0.005834339304039876, 0.00022291449680468154, -0.00011347550301363474, -0.0002789695319528357, 3.9724782763165905e-5, 0.0014346739652022487, -0.0005929663453427555, 0.007760529225787988, -0.0035652377547162766, -8.949797953361954e-7, 4.165583617326475e-7, 0.007758906657929254, -0.0035629218607586507, -0.0014335180425877527, 0.0005927410025651613, -0.00028077701794550534, 3.997146899180175e-5, 0.0004145874489241468, 0.0006287822797273078, 0.0003558895991797996, 0.00041735148639009004, -0.0014753493386684105, -0.003022175674431412, -0.0038499360712092663, -0.009060977228941147, -2.700742108616337e-7, 1.95105508522819e-6, -0.003851077431231356, -0.009057876912750234, 0.0014768106169528894, 0.0030189853718142557, 0.0003560996818065296, 0.0004180139918787877, -0.0004152208120007254, -0.0006289527683073623, 0.0006631308584942151, -0.0003698764268916608, 0.00042573176868662926, -0.0004282951376502011, 0.0005931709205687009, -0.000658020686152334, -0.0038828323174166157, 0.0017573464991351272, -0.008820751809412984, 0.003351877600246701, 1.5566377398494244e-6, 1.2473312451449304e-6, -0.008817857813831287, 0.003356801375305356, 0.0038800366577788612, -0.0017594847166650636, 0.0005925003621435308, -0.0006582517094534173, -0.00042599090097972714, 0.0004279209092314598, 0.0006620041192864341, -0.0003694461086845695, -0.0005331074169542619, -0.0008926741868783218, -0.0005933040387734702, -0.001308195913503675, -0.00019620873720299116, 0.00012391162326190583, -0.0007070252287544916, -0.0007823428049026354, 0.001424736498842517, 0.003632402941793359, 0.0023687908044013224, 0.006988075233598467, 1.7938356249222725e-6, -6.053929943170867e-7, 0.0023742205711954874, 0.006986885334019849, -0.0014265468602381577, -0.003631165500944106, -0.0007062351784828191, -0.0007813221998137066, 0.00019484652164781558, -0.00012361897450433913, -0.0005932614843013143, -0.0013069059674026772, 0.0005334491827991287, 0.000891763288193491, 0.000134883839995984, -0.00015293825408752026, -0.0012077399592268175, 0.0006471761935449732, -0.0015975479425433536, 0.0006294199283595792, 0.00046587928766506363, -3.321395652431667e-5, -0.0008150654440976071, 0.0005201026970173153, 0.002657313881500956, -0.000897810321610877, 0.004523166808952585, -0.0013793832028892393, -1.1281447198630262e-7, -1.6880610765890596e-6, 0.004523072395152267, -0.0013833204039501836, -0.0026569903001041166, 0.0008989350649362684, -0.0008147157057819544, 0.0005180097564705063, -0.0004657201702211001, 3.50449438301749e-5, -0.0015965169223737506, 0.0006301528587649816, 0.001206895459532997, -0.0006475997538144741, 0.0001342936503057093, -0.00015272584076879057, 0.00010258098639006041, 0.00023723226749401715, -0.00019899023178857528, -0.00020196285246777923, 0.0004583859731845535, 0.0009939774911774083, 0.0004974409149509447, 0.0013622404046614407, -0.00010190670677965428, -0.0004221102149386876, 0.0002880191989348116, 0.0006242106125881378, -0.0004953571357954861, -0.0016078418882435504, -0.0006893964049729394, -0.0024901027780182615, -1.202782099814822e-6, 1.5375510051024617e-7, -0.0006919620203754809, -0.002490511515930455, 0.0004959707190962451, 0.0016075789265532854, 0.000286040687502985, 0.0006242669904462572, 0.00010332553666701831, 0.00042217489277812333, 0.0004985159062825206, 0.0013617286461529829, -0.00045852956490345735, -0.0009936078627566965, -0.00019858765443099536, -0.0002018593749083438, -0.00010292146607509249, -0.0002373084724497657, -0.0002768510266784593, 0.00016107137190975035, 0.000280949477690465, -0.00010634885271546872, -0.00016614642068273766, 0.00013991193452730688, 0.0005643685298193936, -0.00021528762081916684, 0.0008447710815956779, -0.0002991224860960759, -0.00022370950884792725, 5.4911842230600464e-5, 0.00035464256813985554, -0.00014111843558039605, -0.0008594464829356918, 0.000252941673947781, -0.001250672740608683, 0.00031601037702520037, 1.4642913539336666e-7, 7.687849765782625e-7, -0.0012506176166353184, 0.0003178294569963648, 0.0008592565201139372, -0.00025324053375180014, 0.00035471432671256375, -0.00013997235050798286, 0.00022363169026127453, -5.5866100357338633e-5, 0.0008445938919856993, -0.00029961842606901506, -0.0005642997655660664, 0.00021527760281513894, -0.00016619866711496854, 0.00013927317468189664, -0.00028081253177308506, 0.00010690699177849888, -0.0002767144520783494, 0.00016121159192623917, 5.640727941026397e-5, 8.442975580833133e-5, 0.00016994924941047038, 0.00032953128197810914, -5.5398064472404534e-5, -0.00018349843633528288, 4.664186518332917e-5, 7.047550296076161e-5, -8.768726637538361e-5, -0.00025458912628811316, -0.0001332854016786693, -0.00040454972322415854, 9.497298783300172e-6, 0.00010007574602933445, -7.23565889854097e-5, -0.00017671236742574964, 0.0001049473326482505, 0.00042219926696102604, 0.00013253209190378223, 0.0005757033126124112, 4.907089436649397e-7, -1.8670495680500913e-8, 0.00013370976620116228, 0.0005755511547406939, -0.00010507825194019764, -0.0004222602309875646, -7.180499504779887e-5, -0.00017678000716239874, -1.015588323600613e-5, -9.986804667544194e-5, -0.00013347220241516732, -0.0004043945632374682, 8.76457831546802e-5, 0.00025455680991659394, 4.6177174257002845e-5, 7.076845663597968e-5, 5.585065109794062e-5, 0.00018319012701501863, 0.0001701406355696551, 0.00032933844807841393, -5.640213978261245e-5, -8.438666933978142e-5, 1.2289813640661255e-6, 2.789193043549997e-6, 9.886689860167366e-5, -5.893474071616938e-5, 0.0002056850077811627, -8.47184532487347e-5, -7.109040431796738e-5, 1.5639300328805035e-5, 6.123685182177096e-6, 1.4699478569655668e-6, -0.00012653171027524838, 4.908756424758246e-5, -0.00017892518731893456, 4.360370079194346e-5, 6.051219967275427e-5, -6.15054274902135e-6, -0.00010308244285549585, 3.2139928119502854e-5, 0.000177106192919264, -2.8592868747778237e-5, 0.00020455795088041392, -4.2003121623827855e-5, 2.683234585065255e-8, -2.75658246208842e-7, 0.0002045977990417062, -4.241594976161203e-5, -0.00017724335897208337, 2.8603300950934614e-5, -0.0001031823559812699, 3.1701260210567354e-5, -6.034285175743819e-5, 6.575825576909066e-6, -0.0001787793095915548, 4.387053599105664e-5, 0.0001264728120622848, -4.906230716578616e-5, 6.25841942211295e-6, 1.7037394122141627e-6, 7.08164557649648e-5, -1.5895268865763837e-5, 0.0002055104591602087, -8.49066270137375e-5, -9.881555469083166e-5, 5.8923708198793274e-5, 1.0861192411945748e-6, 2.684249291250962e-6, -8.107670310174541e-6, -1.5151286669467804e-5, 3.4870296694928544e-6, -5.814034538938241e-7, -2.743797855773752e-5, -5.772740071580533e-5, -1.2784433818076427e-5, -6.0207676910742805e-5, 8.897489368677622e-6, 2.359586339127895e-5, -1.5518209470994366e-6, -3.356752862634222e-6, 2.2405660827372254e-5, 6.956721041190523e-5, 1.5256248569610463e-5, 8.409358422762244e-5, -1.1551693607431556e-5, -2.94496536571693e-5, 6.93178373271497e-6, 5.350309456269035e-5, -1.1296325785617623e-5, -5.320515719874298e-5, -8.368112948824452e-6, -4.815016596652381e-5, -1.0347311423495215e-7, 5.429938229145232e-8, -8.435606824166257e-6, -4.823591464190056e-5, 1.1305699111524335e-5, 5.318000486275159e-5, 6.629475535935906e-6, 5.361369705434512e-5, 1.1721148433162922e-5, 2.9395795375149148e-5, 1.5487516292039034e-5, 8.403675410747412e-5, -2.2399090003681578e-5, -6.95626627337162e-5, -1.4535949976099259e-6, -3.3760291668750702e-6, -9.008068977387606e-6, -2.3495869240530413e-5, -1.2864546459845384e-5, -6.0116591017638236e-5, 2.742390980782007e-5, 5.771611816423773e-5, 3.3693131135937495e-6, -4.307769925037785e-7, 8.190203045218698e-6, 1.5056135856676996e-5, 8.512917748693141e-6, -5.362866800416169e-6, -1.7052617580558496e-5, 8.313232378722608e-6, 2.658983870382389e-7, -2.1043663103323093e-6, -1.1567607145721778e-5, 1.2439515684339442e-6, -4.792735435440556e-6, 1.1735105066645775e-6, 1.6789602095169618e-5, -8.983677331372317e-6, -1.731125898824174e-5, 1.1294172971035943e-5, 1.940460587431464e-5, 1.4815941347127804e-6, 2.706936725470733e-5, -9.847945438461758e-6, 1.0563291459938709e-6, 2.942113579778373e-6, 5.181511084363966e-6, -1.0433869240774447e-6, -1.5229543216624853e-5, 1.1820634184247384e-5, -2.979481592767903e-5, 5.964388450161474e-6, 7.883310627304659e-8, 2.7353102919440572e-8, -2.9730242993159236e-5, 6.090551288043594e-6, 1.5138190888451521e-5, -1.1837256253656986e-5, 5.215582839912455e-6, -9.952122510114653e-7, -1.070584770348685e-6, -2.976387345697492e-6, 2.7066577633593675e-5, -9.873335405070566e-6, -1.9439685264423024e-5, -1.4885499530924105e-6, -1.7353877845417863e-5, 1.1217937966797996e-5, -1.6769922425682215e-5, 9.043771885496046e-6, -4.755444477321581e-6, 1.2001509377890753e-6, 1.1571290271444618e-5, -1.232490780195545e-6, 3.3863215738725425e-7, -2.0336809670073215e-6, 1.695377505229202e-5, -8.398213231056498e-6, 8.476739061460195e-6, -5.39579679398245e-6, -8.883848986455236e-7, -1.0575401262102384e-6, -5.421287934150423e-6, -9.637215487737352e-6, 3.512331822845361e-6, 8.958688954902125e-6, -2.4296599425626e-7, -5.0426609679660974e-8, -1.776776429529255e-6, -3.2792579148583435e-6, 1.0278607704844295e-5, 1.1702228534637153e-5, -4.473942772112289e-7, -7.564753599659141e-6, 4.1048259905933674e-6, 9.11699568944896e-6, 3.2675629720731987e-6, 6.1575977181520396e-6, -3.7503158830587998e-6, 1.770593651952156e-6, -5.581542631076739e-6, -4.6828579604217145e-6, -3.722409994137939e-6, 9.1072429158851e-6, 2.4256028867927638e-6, 1.3561713216158866e-5, 5.723301258950003e-6, 2.8702384813762226e-5, 2.949636132810364e-8, 6.650959078840088e-9, 5.87239209580582e-6, 2.860886588160207e-5, -2.4257555606788006e-6, -1.3585412455470829e-5, -3.7713773277002976e-6, 9.127210220178985e-6, 5.537216461890398e-6, 4.724166357547298e-6, -3.692188511550693e-6, 1.7818248374618437e-6, -3.274828694175986e-6, -6.1548333818325874e-6, 4.0526164080915865e-6, 9.183884171083172e-6, 4.861808496030908e-7, 7.523818941504558e-6, 1.0292982279472246e-5, 1.168406929984009e-5, 1.776558158433187e-6, 3.279753323393638e-6, -2.271802655552049e-7, -6.450949968466268e-8, -3.549636479070351e-6, -8.913397678422505e-6, -5.454098119444312e-6, -9.601778549221267e-6, 8.907884684015816e-7, 1.055787778702771e-6, -2.2662565955911405e-7, 5.199690629177891e-8, -1.152071980921734e-6, 8.483383294012994e-7, -5.027102483081366e-6, 2.1701517044832074e-6, 8.178208392138109e-7, 3.0746048157628826e-7, 5.404400030000371e-7, -4.34144358538044e-7, 2.5220108126945518e-6, -3.30858732705064e-6, 1.2428061303341849e-5, -3.9932344218024125e-6, 3.44459300581364e-6, -4.649818214286044e-6, -7.045555139632578e-6, 5.278940480704455e-6, -2.7605063061576717e-7, 5.142244816318525e-6, -1.2523369294604944e-6, -2.2347356906215617e-6, 6.120371040727999e-6, 1.910225308140126e-6, -6.606066623173596e-6, 1.8065631536166892e-6, 7.090295209402445e-6, 5.632488030700841e-6, -1.6796636852319406e-6, 8.632523993775827e-7, 4.368062188433417e-8, -2.6688822602223483e-8, -1.6544205073753073e-6, 8.750445829128231e-7, -7.162851847457265e-6, -5.644991479805116e-6, -6.616649173545689e-6, 1.7716328432811983e-6, -6.086855721479495e-6, -1.8569050255136966e-6, -1.2289494808099695e-6, -2.2045493771009355e-6, 2.526603314969249e-7, -5.145159764006653e-6, -7.041212795419307e-6, 5.282274407613875e-6, -3.4880475009900217e-6, 4.634549560027626e-6, 1.2415700692194708e-5, -4.005148983177796e-6, -2.5170607053644843e-6, 3.3114454964489707e-6, 5.327682938405942e-7, -4.3690008757170933e-7, -8.134958916474446e-7, -3.0530679235528774e-7, -5.014406049478758e-6, 2.1818610886109307e-6, 1.1507972211594946e-6, -8.498125406898023e-7, -2.1865797473554423e-7, 5.6257710927944294e-8, 5.6758299475459085e-8, 1.369772605842437e-7, 6.725612848358632e-8, 2.6099790743000194e-7, 2.841272771153552e-7, 5.499750889874777e-7, -3.196341410446267e-7, 3.2145504599026357e-7, 4.908903229667133e-7, 1.047044294440652e-6, -3.550191054511998e-8, -3.5395945505295127e-7, -1.8618926004886651e-6, -4.442127458048436e-6, 5.590716704780208e-6, 2.1294942234031085e-6, 1.844001144738606e-7, -2.169911255858107e-6, 2.5628471468052335e-6, 5.735900177757895e-6, 3.1251829635910997e-6, 8.340788538763448e-6, -1.7473398841889447e-6, 8.024512412591013e-6, -3.8075874913833915e-6, -4.5199639790513436e-6, -2.0121071882350296e-6, 1.1007148942367733e-5, 6.177694857592371e-7, 4.1454036039401276e-6, 3.4125841391511923e-6, 1.6340229329483676e-5, 3.868471339191968e-9, 1.3101736978578993e-8, 3.4981407812301457e-6, 1.6275732306832134e-5, -6.177000813217431e-7, -4.16144126620955e-6, -2.0824946861757885e-6, 1.104016225544006e-5, 3.804579716337942e-6, 4.52959255167131e-6, -1.6773151788893073e-6, 8.020040174280816e-6, -3.1295590297705196e-6, -8.339377843212794e-6, 2.548810437941855e-6, 5.766840774069428e-6, -1.8297118915896032e-7, 2.1657617280887315e-6, 5.585875359542431e-6, 2.1346553892296856e-6, 1.8604450365133722e-6, 4.442379408987159e-6, -4.331176782688403e-8, -3.4024845981998154e-7, -4.903455933628908e-7, -1.0493932087110731e-6, -3.2143359251097834e-7, 3.228464320894477e-7, -2.8374413878478995e-7, -5.499401243964568e-7, 7.178468202060875e-8, 2.534356264967737e-7, -5.9581005135027746e-8, -1.330771767064642e-7, -4.695462013350379e-8, 2.9715043878958716e-8, 1.4704695059054881e-7, -5.8142013104658795e-8, 1.3811531393341605e-7, -4.129493282067195e-8, -4.067092377153016e-9, 8.586227963028898e-8, -7.393313791481442e-7, 3.2857785244057803e-7, -4.953239213713022e-7, 4.809335110116267e-7, 2.598381540289731e-7, -2.843484524200561e-7, 6.355489955998256e-7, -1.9534758000333506e-6, 5.922047775534696e-6, -1.8928792047954131e-6, 3.5417081138440586e-6, -3.6776452445239182e-6, -5.099178000349046e-6, 3.669937144173913e-6, 1.3529577724687278e-6, 3.689841700446005e-6, 5.88087308882216e-7, -1.7556338593103544e-6, 4.335112761167887e-6, 1.5495532384424205e-6, -3.670626774685218e-6, 9.238150033411117e-7, 3.966291137977427e-6, 4.8739584211691085e-6, -3.0310310997539226e-6, 8.957086507626226e-7, 3.977818036737139e-8, -1.5183839406222824e-8, -3.0083752682396975e-6, 9.158137436084737e-7, -4.025428416486324e-6, -4.884434041864667e-6, -3.672654591053697e-6, 9.095945267597206e-7, -4.316438578367113e-6, -1.5181115053032512e-6, 6.020886069112472e-7, -1.7437714705153638e-6, -1.3729117232024175e-6, -3.6923086779093807e-6, -5.104326992561343e-6, 3.6641263181300502e-6, -3.56381912145842e-6, 3.67756722299647e-6, 5.920875938754458e-6, -1.8946435928907585e-6, -6.321081879322332e-7, 1.956132658275313e-6, 2.6348854062664306e-7, -2.7976904884913995e-7, 4.863789436220698e-7, -4.884593491145238e-7, -7.398795538674487e-7, 3.2870302774626085e-7, 3.6534736441963215e-9, -8.667731612768436e-8, 1.3557732327763403e-7, -4.335098976146371e-8, -1.4338808471634715e-7, 6.090982659398631e-8, -4.5962347814515637e-8, 3.066916958298759e-8, 6.95448066185579e-9, 5.2817207929075e-9, 2.822193879833118e-8, 4.967724649145174e-8, -2.32378118120694e-8, -6.64470601262212e-8, -3.098454208760448e-9, -7.0520937653772414e-9, 3.1522077410722614e-8, 8.340661217986141e-8, -3.640826908316071e-7, -2.49260389442364e-7, 2.838574429534806e-7, 7.510098815826084e-7, -7.496685864210505e-8, -2.866683651883052e-7, -9.817529306398006e-7, -2.408449862826356e-6, 4.390778111878156e-6, 2.1204183497610587e-6, 1.6251966007339984e-7, -1.5733084353135725e-6, 2.152117086541164e-6, 4.811611517691148e-6, 2.029225979511874e-6, 5.434078720386542e-6, -1.5481458071933517e-6, 5.887906522580007e-6, -2.703424928332652e-6, -3.0396133845543042e-6, -1.7411694883389341e-6, 8.629316391822955e-6, 4.761454724790729e-7, 3.432276866982801e-6, 2.79223691706378e-6, 1.3807959893819993e-5, 5.173894998747642e-9, 8.214131223363219e-9, 2.866130270565332e-6, 1.3755412935400095e-5, -4.7571020335570133e-7, -3.444791827730074e-6, -1.7908174864217167e-6, 8.653756903474579e-6, 2.6977891151269455e-6, 3.0496258761528774e-6, -1.4979890422611334e-6, 5.883398025508599e-6, -2.0318038585261248e-6, -5.433030646881355e-6, 2.136638552935148e-6, 4.838197813690061e-6, -1.583421099308532e-7, 1.5667288269900544e-6, 4.390083082222976e-6, 2.121023061485674e-6, 9.807521422065077e-7, 2.4083474489989683e-6, -7.780044516424736e-8, -2.803353720254787e-7, -2.863771232418521e-7, -7.488169005401959e-7, -3.6765540443676555e-7, -2.453132149528797e-7, -3.1353578242919145e-8, -8.345782654932999e-8, -3.028916800447485e-9, -7.750768879402755e-9, 2.424344790896526e-8, 6.531945081422943e-8, 2.911425926148834e-8, 4.877264846297269e-8, -7.035309547679232e-9, -5.2672218098935745e-9, 9.230179348960898e-10, 1.9289355779686883e-10, 5.128878766975652e-9, -6.211816369839207e-9, 2.11574295461507e-8, -8.464220688231415e-9, 4.969029635111412e-9, -4.32046702271741e-9, 2.5026299776388842e-8, -1.2360675058437302e-8, -5.1121309646055376e-8, 8.4161104259887e-8, -4.7628134731041115e-7, 1.91777731983512e-7, -2.806597268883128e-7, 3.3451439624684245e-7, 1.5894141447846365e-7, -1.5879846833141595e-7, 5.394693486286095e-7, -1.517725457669546e-6, 3.991679313697729e-6, -1.2114392267048063e-6, 2.796333719495475e-6, -2.938312423757954e-6, -3.537276081931766e-6, 2.5367683862371975e-6, 1.030194771940252e-6, 3.014012582684305e-6, 1.7519781470336196e-7, -1.2079025074082587e-6, 3.5168254137648806e-6, 1.293261293837687e-6, -2.760505795202217e-6, 6.504542437907745e-7, 3.389674749939931e-6, 3.989676893678535e-6, -2.208877741644057e-6, 6.605532575187441e-7, 3.182442066534006e-8, -1.2314672965862183e-8, -2.1927794574832547e-6, 6.736000293772066e-7, -3.4382627357455713e-6, -3.998312630663704e-6, -2.7634744056665337e-6, 6.392806272085929e-7, -3.5007754281988162e-6, -1.267552591640855e-6, 1.8266670728034189e-7, -1.1966161756290745e-6, -1.0456100222627013e-6, -3.0153252479678367e-6, -3.539830936204091e-6, 2.5338594123364336e-6, -2.815121404472631e-6, 2.9371510249220214e-6, 3.990032381713318e-6, -1.213557493731866e-6, -5.370123674451857e-7, 1.5194319821694277e-6, 1.5993030008521147e-7, -1.5679421285755574e-7, 2.757079564462063e-7, -3.385539116581367e-7, -4.7579688012571734e-7, 1.9251987206788312e-7, 5.08544080813521e-8, -8.468446734788606e-8, 2.4888594890565532e-8, -1.2618057306319274e-8, -4.535386892590642e-9, 4.5720828643753984e-9, 2.0917707432309246e-8, -8.724619219260386e-9, -5.1211850549861424e-9, 6.2756420112300425e-9, 8.143926664935328e-10, 1.4328047236077323e-10, -6.715804906585615e-11, -4.666112744015348e-10, -4.989943128250984e-10, -1.2631922699389032e-9, -1.4585029815723532e-9, -1.6824008850000552e-9, 4.69295733727409e-9, 3.4736993468415683e-9, -4.5683207679545644e-9, -1.2220417256111648e-8, -4.024601173743633e-9, 3.4215881206477567e-9, 2.1602280633623943e-8, 5.504393260352723e-8, -2.498594688676322e-7, -1.4127719567805199e-7, 1.6425753400219322e-7, 4.3643142434492937e-7, -5.6329465625141596e-8, -2.3005519751786666e-7, -6.357448213867761e-7, -1.6044112277030772e-6, 3.477442292506591e-6, 1.6400730914810593e-6, 1.39015269657711e-7, -1.0617251000089139e-6, 1.768191025284682e-6, 3.960483332755692e-6, 1.4455690111465538e-6, 3.959045939977729e-6, -1.303336249120324e-6, 4.844662621122182e-6, -1.978770651484798e-6, -2.208111154805395e-6, -1.4451800063390934e-6, 7.157984038116103e-6, 3.180341760974621e-7, 2.5265193813840593e-6, 2.275359542774928e-6, 1.141173142099366e-5, 3.6078664549657666e-9, 6.32926044094777e-9, 2.334345228254805e-6, 1.1369270860731336e-5, -3.180697282295371e-7, -2.5358886979796975e-6, -1.4892910034403103e-6, 7.176621671714929e-6, 1.975010247794755e-6, 2.215116095812987e-6, -1.2614053702133664e-6, 4.841572715148668e-6, -1.4472636860804708e-6, -3.958680844011838e-6, 1.7559788659183342e-6, 3.98209007431996e-6, -1.3648413556219952e-7, 1.0582418888713453e-6, 3.4766162327533014e-6, 1.6407079465690721e-6, 6.349399034608696e-7, 1.6045135679465583e-6, -5.884895289362377e-8, -2.2468783714697776e-7, -1.6544985532483178e-7, -4.355991350662808e-7, -2.52071939642512e-7, -1.3875145421346342e-7, -2.1508753203108305e-8, -5.507738850158865e-8, -3.737372943351527e-9, 2.577287525319104e-9, 4.701888473388684e-9, 1.2139212099061885e-8, 4.825235037012136e-9, 3.33335684109068e-9, 1.4617196520478338e-9, 1.6864900866505931e-9, -5.519531375020591e-10, -1.1622000768768714e-9, 9.538940351294336e-11, 4.2602646036965344e-10, 3.647258789436774e-10, -3.1138934529602434e-10, -3.9860204013993025e-10, 9.235026904661433e-11, -1.1128822177379935e-9, 1.3027837739328006e-9, 6.57991555444606e-10, -1.1886591792378544e-9, 5.2544142894072955e-9, -2.484896920576826e-9, 7.185136829593573e-9, -3.5952893067423067e-9, 1.307840021628761e-8, -4.734391477238513e-9, -3.148342531538012e-8, 5.803851269045699e-8, -2.817141476816352e-7, 1.1063255869175997e-7, -2.176269868139327e-7, 2.56279761546679e-7, 1.0869304556946886e-7, -1.0751486740121295e-7, 4.078508696215011e-7, -1.1998461321583706e-6, 2.770639973244145e-6, -8.134471741841972e-7, 2.301706350960611e-6, -2.4029924616979558e-6, -2.584842926001167e-6, 1.8474873599856735e-6, 8.837709379126651e-7, 2.4861485485750635e-6, 6.789107976319133e-8, -8.7983266655784e-7, 2.8902052373385613e-6, 1.0882102986438493e-6, -2.074174640407934e-6, 4.620360158635814e-7, 2.823420592787149e-6, 3.341246153901804e-6, -1.7298586276556773e-6, 5.10320140913776e-7, 2.6443485778590415e-8, -1.0411814098771362e-8, -1.717418966164469e-6, 5.206126023977909e-7, -2.8645730082854382e-6, -3.348579060104879e-6, -2.076125993584479e-6, 4.5317932529393306e-7, -2.8761083996792492e-6, -1.0682155046220438e-6, 7.481045388476617e-8, -8.72309981830497e-7, -8.959136523494034e-7, -2.4877632042048355e-6, -2.5875514032471045e-6, 1.8455983386714797e-6, -2.3167663737183164e-6, 2.4020096180896915e-6, 2.7695262940435885e-6, -8.150884448630075e-7, -4.057672023855274e-7, 1.2013583094922707e-6, 1.092687985077524e-7, -1.060491871665895e-7, 2.1365183642326178e-7, -2.594863934952683e-7, -2.8153582815205864e-7, 1.110203644570513e-7, 3.127699515826451e-8, -5.841818939020435e-8, 1.291771219483716e-8, -4.946641868536123e-9, -6.75110640182196e-9, 3.861107875581216e-9, 5.235787633128492e-9, -2.52326200071214e-9, -6.526173331588675e-10, 1.2091705564806251e-9, -1.0844959279115197e-9, 1.3254612731561132e-9, 3.6127240787430084e-10, -1.2019821342309004e-10, 3.5672540597964196e-10, -3.187128280090408e-10, -5.514679260462944e-11, -2.6191694665556844e-11, -5.1518371896506035e-11, -2.1087956778769144e-10, 4.402368267346726e-11, 1.897101799781014e-10, 1.4980529271337366e-10, 8.451203394201995e-11, -2.23537138075366e-10, -4.4266336747067785e-10, 2.7684263982820586e-9, 4.854252115052867e-9, -1.8582305289328119e-9, -7.286153291848915e-9, -3.509987855864722e-9, 4.264358157999826e-10, 1.2384230614369654e-8, 3.4933109272268614e-8, -1.7147164748298227e-7, -1.8551868543388848e-7, 9.624554710399636e-8, 2.9248945308996593e-7, -1.103761078178854e-7, -1.4055846498930933e-7, -4.586542916531291e-7, -1.255694995987921e-6, 3.7434782761719356e-6, 2.3752383602471837e-6, -2.13884482076009e-7, -1.7304290170568494e-6, 1.1022575254911118e-6, 4.297358252481415e-6, 1.91917872742574e-6, 4.6762420545311994e-6, -8.388884023190586e-6, -6.688631228742465e-7, -2.6352433345141334e-6, -2.351697896234534e-6, -5.496884903722683e-6, 2.506442142266882e-7, 1.0593677874680515e-6, 1.6872032890264766e-6, 1.0166340089233341e-5, 7.284321589750043e-6, 4.7790334015099024e-9, 1.75160366080213e-9, 1.0174211923192758e-5, 7.243647857343054e-6, -1.058639974088763e-6, -1.6895587567693153e-6, -5.5329855807379605e-6, 2.4333347891403035e-7, 2.62474361208086e-6, 2.354700051702649e-6, -8.357843104603801e-6, -6.470994911849709e-7, -1.915162852315851e-6, -4.674780801856114e-6, 1.0750539530340927e-6, 4.319880787794798e-6, 2.1582921574843017e-7, 1.7274207422414682e-6, 3.751085623315029e-6, 2.377464675068608e-6, 4.574798581881975e-7, 1.2556244704657617e-6, -1.1483347078284348e-7, -1.3815313234621244e-7, -9.718147836362468e-8, -2.916475317775158e-7, -1.7500731301481397e-7, -1.8314656163351745e-7, -1.2297102008690884e-8, -3.495180676468891e-8, -3.1054995000292515e-9, -7.196525452138644e-11, 1.9722895862957033e-9, 7.174082695399923e-9, 2.955209213516216e-9, 4.730963397910298e-9, 2.229696509601488e-10, 4.4447239690509687e-10, 1.4028989945551806e-10, 9.871659703959339e-11, -5.4205169937043054e-11, -1.7617847498183774e-10, -6.338713883698546e-11, -2.0499921180430158e-10, 5.601629553056099e-11, 2.633463218365656e-11};
    FLOAT *d_y_q2_accum = NULL;
    GPUCHECK(gpuMalloc(&d_y_q2_accum, 1056 * sizeof(FLOAT)));
    GPUCHECK(gpuMemcpy(d_y_q2_accum, y_q2_accum, 1056 * sizeof(FLOAT), gpuMemcpyHostToDevice));
    printf("Here2\n");
    const int8_t y_m_accum[528] = {-1, 0, 1, -2, -1, 0, 1, 2, -3, -2, -1, 0, 1, 2, 3, -4, -3, -2, -1, 0, 1, 2, 3, 4, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22};
    int8_t *d_y_m_accum = NULL;
    GPUCHECK(gpuMalloc(&d_y_m_accum, 528 * sizeof(int8_t)));
    GPUCHECK(gpuMemcpy(d_y_m_accum, y_m_accum, 528 * sizeof(int8_t), gpuMemcpyHostToDevice));
    const int8_t y_n_accum[528] = {1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22};
    int8_t *d_y_n_accum = NULL;
    GPUCHECK(gpuMalloc(&d_y_n_accum, 528 * sizeof(int8_t)));
    GPUCHECK(gpuMemcpy(d_y_n_accum, y_n_accum, 528 * sizeof(int8_t), gpuMemcpyHostToDevice));
    const int8_t y_m_signs[528] = {1, 1, -1, 1, 1, 1, -1, 1, 1, 1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1};
    int8_t *d_y_m_signs = NULL;
    GPUCHECK(gpuMalloc(&d_y_m_signs, 528 * sizeof(int8_t)));
    GPUCHECK(gpuMemcpy(d_y_m_signs, y_m_signs, 528 * sizeof(int8_t), gpuMemcpyHostToDevice));
    const int8_t y_m_abs_m[528] = {1, 0, 1, 2, 1, 0, 1, 2, 3, 2, 1, 0, 1, 2, 3, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22};
    int8_t *d_y_m_abs_m = NULL;
    GPUCHECK(gpuMalloc(&d_y_m_abs_m, 528 * sizeof(int8_t)));
    GPUCHECK(gpuMemcpy(d_y_m_abs_m, y_m_abs_m, 528 * sizeof(int8_t), gpuMemcpyHostToDevice));
    const int32_t y_lengths[1] = {528};
    int32_t *d_y_lengths = NULL;
    GPUCHECK(gpuMalloc(&d_y_lengths, 1 * sizeof(int32_t)));
    GPUCHECK(gpuMemcpy(d_y_lengths, y_lengths, 1 * sizeof(int32_t), gpuMemcpyHostToDevice));
    const int32_t y_offsets[1] = {0};
    int32_t *d_y_offsets = NULL;
    GPUCHECK(gpuMalloc(&d_y_offsets, 1 * sizeof(int32_t)));
    GPUCHECK(gpuMemcpy(d_y_offsets, y_offsets, 1 * sizeof(int32_t), gpuMemcpyHostToDevice));
    printf("Here3\n");

    const int32_t num_coeffs = 1;
    const int32_t num_unique_tiles = 1;
    const int32_t num_unique_freqs = 1;
    const int8_t n_max = 22;

    const FEECoeffs coeffs = {
        d_x_q1_accum,
        d_x_q2_accum,
        d_x_m_accum,
        d_x_n_accum,
        d_x_m_signs,
        d_x_m_abs_m,
        d_x_lengths,
        d_x_offsets,
        d_y_q1_accum,
        d_y_q2_accum,
        d_y_m_accum,
        d_y_n_accum,
        d_y_m_signs,
        d_y_m_abs_m,
        d_y_lengths,
        d_y_offsets,
        n_max};
    // FEECoeffs *d_coeffs = NULL;
    // GPUCHECK(gpuMalloc(&d_coeffs, sizeof(FEECoeffs)));
    // GPUCHECK(gpuMemcpy(d_coeffs, &coeffs, sizeof(FEECoeffs), gpuMemcpyHostToDevice));

    const FLOAT latitude_rad = -0.4660608448386394; // MWA
    FLOAT *d_latitude_rad = NULL;
    GPUCHECK(gpuMalloc(&d_latitude_rad, sizeof(FLOAT)));
    GPUCHECK(gpuMemcpy(d_latitude_rad, &latitude_rad, sizeof(FLOAT), gpuMemcpyHostToDevice));

    // sanity check : device can access coeffs
    // dim3 gridDim = dim3(1, 1, 1);
    // dim3 blockDim = dim3(1, 1, 1);
    // print_coeffs<<<gridDim, blockDim>>>(coeffs);
    // GPUCHECK(gpuDeviceSynchronize());

    JONES *d_results = NULL;
    GPUCHECK(gpuMalloc(&d_results, num_unique_tiles * num_unique_freqs * num_directions * sizeof(JONES)));

    printf("Here4\n");
    const char *error_message_ptr = gpu_fee_calc_jones(
        d_azs, d_zas, num_directions, &coeffs, num_coeffs, NULL, d_latitude_rad, 1, d_results);
    printf("Here5\n");
    GPUCHECK(gpuDeviceSynchronize());
    printf("Here6\n");
    if (error_message_ptr != NULL)
    {
        printf("Error: %s\n", error_message_ptr);
        return 1;
    }
    printf("Here7\n");

    FLOAT results[num_unique_tiles * num_unique_freqs * num_directions * 8];
    GPUCHECK(gpuMemcpy(results, d_results, num_unique_tiles * num_unique_freqs * num_directions * 8 * sizeof(FLOAT), gpuMemcpyDeviceToHost));
    printf("Here8\n");
    for (int i = 0; i < num_directions; i++)
    {
        printf("[%3d] %f %f %f %f %f %f %f %f\n", i, results[i * 8], results[i * 8 + 1], results[i * 8 + 2], results[i * 8 + 3], results[i * 8 + 4], results[i * 8 + 5], results[i * 8 + 6], results[i * 8 + 7]);
    }

    return 0;
}
